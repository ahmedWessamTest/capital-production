import{a as Ge}from"./chunk-27FMFNBH.js";import{a as Re}from"./chunk-IOSVVL6Q.js";import{a as Je}from"./chunk-TSV364RR.js";import{a as Ye}from"./chunk-JJTVBBNG.js";import{a as ze}from"./chunk-QJDVDDUB.js";import{a as qe}from"./chunk-BPYLSISH.js";import{a as Ue}from"./chunk-MYIVE22L.js";import{b as Ce}from"./chunk-WTXMMYIH.js";import{e as Se}from"./chunk-MJN5VWZP.js";import{a as Pe,b as Ie,c as m,d as q,e as Me,h as Oe,i as Te,j as Ee,l as je,m as Ne,n as Le,o as ke,p as De,q as Ve,r as Be,u as Ae,v as $e,w as He}from"./chunk-6G7SZGYW.js";import{a as Fe}from"./chunk-U6POVDGM.js";import{o as ye}from"./chunk-QZHVMEMD.js";import{$ as L,$b as xe,Bb as ue,Da as x,Ga as s,Hb as ge,Ia as w,Ib as V,J as ie,Jb as B,K as ne,Ra as l,Sa as c,Ta as C,Tb as A,Ua as M,Ub as fe,Va as O,Wa as I,Xa as F,Y as re,Ya as p,Yb as he,Z as b,Za as se,_ as y,a as G,aa as oe,cc as ve,db as le,eb as u,fa as K,fb as W,g as ee,gb as h,h as te,hb as Q,jb as ce,ka as ae,kb as de,lb as pe,lc as be,nb as D,ob as T,pb as S,q as J,ta as o,tb as g,tc as $,ub as f,uc as H,vb as me,vc as U,wc as we,xa as v,xb as _e,ya as k,z as Y}from"./chunk-XFMLYWXN.js";function it(r,t){if(r&1&&(l(0,"span",7)(1,"div",8),u(2,"+"),c(),l(3,"div",9),u(4),c(),l(5,"div",10),u(6),g(7,"translate"),c(),l(8,"div",11),u(9),c()()),r&2){let e=p();o(4),W(e.selectedOption.title),o(2),Q(" (",f(7,4,"dropdown.policy_code_prefix")," ",e.selectedOption.code,") "),o(3),h(" ( ",e.selectedOption.code,") ")}}function nt(r,t){r&1&&(u(0),g(1,"translate")),r&2&&h(" ",f(1,1,"dropdown.select_option")," ")}function rt(r,t){r&1&&(l(0,"div",17),u(1),g(2,"translate"),c()),r&2&&(o(),h(" ",f(2,1,"dropdown.loading")," "))}function ot(r,t){r&1&&(l(0,"div",17),u(1),g(2,"translate"),c()),r&2&&(o(),h(" ",f(2,1,"dropdown.no_policies_available")," "))}function at(r,t){if(r&1){let e=I();M(0),l(1,"div",19)(2,"div",20),F("click",function(){b(e);let n=p().$implicit,a=p(3);return y(a.selectOption(n))}),l(3,"div",21),u(4,"+"),c(),l(5,"div",22),u(6),c(),l(7,"div",23),u(8),g(9,"translate"),c(),l(10,"div",24),u(11),c(),l(12,"label",25),u(13),g(14,"translate"),l(15,"input",26),pe("ngModelChange",function(n){b(e);let a=p().$implicit;return de(a.agreed,n)||(a.agreed=n),y(n)}),c(),C(16,"span",27),c()()(),O()}if(r&2){let e=p().$implicit;o(6),W(e.title),o(2),Q(" ",f(9,6,"dropdown.policy_code_prefix_short"),' "',e.code,'" '),o(3),h(' "',e.code,'" '),o(2),h(" ",f(14,8,"dropdown.agree_to_terms")," "),o(2),ce("ngModel",e.agreed)}}function st(r,t){if(r&1&&(M(0),x(1,at,17,10,"ng-container",15),O()),r&2){let e=t.$implicit;o(),s("ngIf",!(e!=null&&e.disabled))}}function lt(r,t){if(r&1&&(M(0),x(1,st,2,1,"ng-container",18),O()),r&2){let e=p(2);o(),s("ngForOf",e.options)}}function ct(r,t){if(r&1){let e=I();l(0,"div",28),F("click",function(){b(e);let n=p(2);return y(n.onManualPolicyAdd())}),l(1,"div"),C(2,"img",29),c(),l(3,"div",30),u(4),g(5,"translate"),c()()}r&2&&(o(4),h(" ",f(5,1,"dropdown.add_manual_policy")," "))}function dt(r,t){if(r&1&&(l(0,"div",12)(1,"div",13),x(2,rt,3,3,"div",14)(3,ot,3,3,"div",14)(4,lt,2,1,"ng-container",15),c(),x(5,ct,6,3,"div",16),c()),r&2){let e=p();o(2),s("ngIf",e.isLoading),o(),s("ngIf",!e.isLoading&&e.options.length===0),o(),s("ngIf",!e.isLoading&&e.options.length>0),o(),s("ngIf",!e.isLoading)}}var z=class r{constructor(t){this.translate=t}options=[];isLoading=!1;selected=new K;manualPolicyAdd=new K;isOpen=!1;selectedOption;manualAddOption={title:"dropdown.add_manual_policy",code:"MANUAL",agreed:!1};ngOnChanges(t){t.options&&(this.selectedOption=void 0),t.isLoading&&this.isLoading&&(this.isOpen=!0)}toggleDropdown(){this.isOpen=!this.isOpen}selectOption(t){this.options.forEach(e=>{e.agreed=e===t}),this.selectedOption=t,this.isOpen=!1,this.selected.emit(t)}onManualPolicyAdd(){this.selectedOption={title:this.translate.instant(this.manualAddOption.title),code:this.manualAddOption.code,agreed:this.manualAddOption.agreed},this.isOpen=!1,this.selected.emit(this.selectedOption),this.manualPolicyAdd.emit()}static \u0275fac=function(e){return new(e||r)(v($))};static \u0275cmp=k({type:r,selectors:[["app-custome-drop-menu"]],inputs:{options:"options",isLoading:"isLoading"},outputs:{selected:"selected",manualPolicyAdd:"manualPolicyAdd"},features:[re],decls:8,vars:3,consts:[["placeholder",""],[1,"relative"],[1,"w-[100%]","p-4","rounded-[30px]","px-8","h-[73px]","cursor-pointer","flex","justify-between","items-center","bg-white","shadow",3,"click"],["class","flex gap-4 min-w-0",4,"ngIf","ngIfElse"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute w-[100%] bg-white rounded-[30px] shadow mt-1 z-10",4,"ngIf"],[1,"flex","gap-4","min-w-0"],[1,"flex-shrink-0"],[1,"min-w-0","truncate"],[1,"hidden","md:flex","flex-1","text-center","text-gray-500","min-w-0","truncate"],[1,"md:hidden","flex-1","text-center","text-gray-500","min-w-0","truncate"],[1,"absolute","w-[100%]","bg-white","rounded-[30px]","shadow","mt-1","z-10"],[1,"max-h-[120px]","md:max-h-[200px]","overflow-y-auto"],["class","px-8 py-2 text-center text-gray-500 h-[48px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],["class","w-full p-2 md:p-4 flex items-center gap-4  px-8 cursor-pointer border-t border-gray-200 h-[70px]",3,"click",4,"ngIf"],[1,"px-8","py-2","text-center","text-gray-500","h-[48px]","flex","items-center","justify-center"],[4,"ngFor","ngForOf"],[1,"px-8","py-1","md:py-2","hover:bg-gray-100","cursor-pointer","h-[40px]","md:h-[70px]","flex","items-center"],[1,"flex","items-center","w-full","min-w-0",3,"click"],[1,"text-xl","text-green-500","font-bold","flex-shrink-0","mr-2"],[1,"font-semibold","min-w-0","text-[12px]","md:text-[14px]","truncate"],[1,"hidden","md:flex","text-gray-400","text-sm","flex-1","text-center","ms-2","min-w-0","truncate"],[1,"md:hidden","text-gray-400","text-[12px]","flex-1","text-center","ms-2","min-w-0","truncate"],[1,"hidden","md:flex","custom-checkbox-wrapper","gap-2","items-center","text-sky-400","text-sm","flex-shrink-0","ml-4"],["type","checkbox",1,"hidden-checkbox",3,"ngModelChange","ngModel"],[1,"styled-checkbox","cursor-pointer"],[1,"w-full","p-2","md:p-4","flex","items-center","gap-4","px-8","cursor-pointer","border-t","border-gray-200","h-[70px]",3,"click"],["src","./assets/icons/plus.png","alt","Add Icon"],[1,"flex","cursor-pointer","justify-around","choose-from-your-policies","text-base","sm:text-lg","md:text-xl","flex-1","min-w-0","truncate"]],template:function(e,i){if(e&1){let n=I();l(0,"div",1)(1,"div",2),F("click",function(){return b(n),y(i.toggleDropdown())}),x(2,it,10,6,"span",3)(3,nt,2,3,"ng-template",null,0,_e),L(),l(5,"svg",4),C(6,"path",5),c()(),x(7,dt,6,4,"div",6),c()}if(e&2){let n=le(4);o(2),s("ngIf",i.selectedOption)("ngIfElse",n),o(5),s("ngIf",i.isOpen)}},dependencies:[A,V,B,$e,Pe,q,Oe,U,H],styles:['.hidden-checkbox[_ngcontent-%COMP%]{display:none}.styled-checkbox[_ngcontent-%COMP%]{width:16px;height:16px;background-color:#fff;border:2px solid #38bdf8;border-radius:4px;display:inline-block;position:relative}.hidden-checkbox[_ngcontent-%COMP%]:checked + .styled-checkbox[_ngcontent-%COMP%]:after{content:"";position:absolute;left:4px;top:0;width:4px;height:8px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.hidden-checkbox[_ngcontent-%COMP%]:checked + .styled-checkbox[_ngcontent-%COMP%]{background-color:#38bdf8;border-color:#38bdf8}.choose-from-your-policies[_ngcontent-%COMP%]{color:#37a6de;text-align:center;font-family:Alexandria;font-size:clamp(16px,1.5vw,24px);font-style:normal;font-weight:400;line-height:22px;text-transform:capitalize;text-align:start}']})};var P=(r,t)=>({"text-right":r,"text-left":t}),E=r=>({"order-2":r}),pt=()=>["fullName","email","phoneNumber"],mt=()=>["birthdate","gender","insurancePolicyNumber","car_type_id","car_brand_id","car_model_id","car_year","car_price","medical_insurance_id","motor_insurance_id","building_type_id","building_country_id","building_price","building_insurance_id","jop_title","jop_price","jop_main_id","jop_second_id"],_t=()=>["car_price","jop_price"];function ut(r,t){r&1&&(M(0),C(1,"app-heading",10),g(2,"translate"),O()),r&2&&(o(),s("headingText",f(2,3,"claims"))("showStartSvg",!0)("showEndSvg",!1))}function gt(r,t){if(r&1){let e=I();l(0,"button",11),F("click",function(){let n=b(e).$implicit,a=p();return y(a.selectInsuranceType(n))}),u(1),g(2,"customTranslate"),c()}if(r&2){let e=t.$implicit;w("active",e.active),o(),h(" ",me(2,3,e,"name")," ")}}function ft(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(2);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("fullName")," ")}}function ht(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(2);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("phoneNumber")," ")}}function xt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(2);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("email")," ")}}function vt(r,t){if(r&1){let e=I();M(0),l(1,"div",12)(2,"div",13)(3,"p",14),u(4),g(5,"translate"),c()()(),l(6,"div",12)(7,"div",15)(8,"input",16),g(9,"translate"),F("input",function(n){b(e);let a=p();return y(a.restrictToLetters(n))}),c()(),l(10,"div",17),x(11,ft,2,4,"span",18),c()(),l(12,"div",12)(13,"div",15)(14,"input",19),g(15,"translate"),F("input",function(n){b(e);let a=p();return y(a.RestirctToNumbers(n))}),c()(),l(16,"div",17),x(17,ht,2,4,"span",18),c()(),l(18,"div",12)(19,"div",15),C(20,"input",20),g(21,"translate"),c(),l(22,"div",17),x(23,xt,2,4,"span",18),c()(),l(24,"button",21),F("click",function(){b(e);let n=p();return y(n.onNextStep())}),u(25),g(26,"translate"),g(27,"translate"),c(),O()}if(r&2){let e=p();o(2),s("ngClass",S(34,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(2),h(" ",f(5,22,"pages.home_form.user_info_description")," "),o(4),w("error",e.isFieldInvalid("fullName")),s("readOnly",e.userDataStatus.fullName)("placeholder",f(9,24,e.formFieldsConfig.fullName.placeholder))("ngClass",S(37,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("fullName")),o(3),w("error",e.isFieldInvalid("phoneNumber")),s("readOnly",e.userDataStatus.phoneNumber)("placeholder",f(15,26,e.formFieldsConfig.phoneNumber.placeholder))("ngClass",S(40,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("phoneNumber")),o(3),w("error",e.isFieldInvalid("email")),s("readOnly",e.userDataStatus.email)("placeholder",f(21,28,e.formFieldsConfig.email.placeholder))("ngClass",S(43,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("email")),o(),s("disabled",e.claimForm.invalid||e.isLoadingNext),o(),h(" ",e.isLoadingNext?f(26,30,"pages.home_form.loading"):f(27,32,"pages.home_form.next_button")," ")}}function bt(r,t){if(r&1&&(C(0,"input",32),g(1,"translate")),r&2){let e=p(3).$implicit,i=p(2);w("error",i.isFieldInvalid(e)),s("type",i.formFieldsConfig[e].type||"text")("id",e)("formControlName",e)("placeholder",f(1,7,i.formFieldsConfig[e].placeholder))("ngClass",S(9,P,i.translate.currentLang==="ar",i.translate.currentLang==="en"))}}function yt(r,t){if(r&1){let e=I();l(0,"input",33),g(1,"translate"),F("input",function(n){b(e);let a=p(5);return y(a.RestirctToNumbers(n))}),c()}if(r&2){let e=p(5);w("error",e.isFieldInvalid("car_price")),s("placeholder",f(1,4,e.formFieldsConfig.car_price.placeholder))("ngClass",S(6,P,e.translate.currentLang==="ar",e.translate.currentLang==="en"))}}function Ct(r,t){if(r&1&&(C(0,"input",34),g(1,"translate")),r&2){let e=p(5);w("error",e.isFieldInvalid("jop_price")),s("placeholder",f(1,4,e.formFieldsConfig.jop_price.placeholder))("ngClass",S(6,P,e.translate.currentLang==="ar",e.translate.currentLang==="en"))}}function Ft(r,t){if(r&1){let e=I();l(0,"div",35)(1,"input",36),F("change",function(n){b(e);let a=p(3).$implicit,_=p(2);return y(a==="jop_main_id"?_.onMainIdFileSelect(n):_.onSecondIdFileSelect(n))}),c(),l(2,"button",37),F("click",function(){b(e);let n=p(3).$implicit,a=p(2);return y(a.triggerFileInput(n))}),L(),l(3,"svg",38),C(4,"path",39),c(),oe(),l(5,"span"),u(6),g(7,"translate"),c()()()}if(r&2){let e=p(3).$implicit,i=p(2);o(),s("id",e),o(),w("border-red-500",i.isFieldInvalid(e))("border-green-500",e==="jop_main_id"&&i.selectedMainIdFile||e==="jop_second_id"&&i.selectedSecondIdFile),o(4),h(" ",e==="jop_main_id"&&i.selectedMainIdFile?i.selectedMainIdFile.name:e==="jop_second_id"&&i.selectedSecondIdFile?i.selectedSecondIdFile.name:f(7,6,i.formFieldsConfig[e].placeholder)," ")}}function wt(r,t){if(r&1&&(l(0,"option",47),u(1),g(2,"translate"),c()),r&2){let e=t.$implicit;s("value",e.value),o(),h(" ",f(2,2,e.label)," ")}}function St(r,t){if(r&1){let e=I();l(0,"div",40)(1,"select",41),F("change",function(n){b(e);let a=p(3).$implicit,_=p(2);return y(a==="car_brand_id"?_.onCarBrandChange(n):a==="building_type_id"?_.onBuildingTypeChange(n):a==="car_model_id"?_.onCarModelChange(n):a==="jop_title"?_.onJobTitleChange(n):null)}),l(2,"option",42),u(3),g(4,"translate"),c(),x(5,wt,3,4,"option",43),c(),l(6,"div",44),L(),l(7,"svg",45),C(8,"path",46),c()()()}if(r&2){let e=p(3).$implicit,i=p(2);o(),w("error",i.isFieldInvalid(e)),s("id",e)("formControlName",e)("ngClass",S(9,P,i.translate.currentLang==="ar",i.translate.currentLang==="en")),o(2),h(" ",f(4,7,i.formFieldsConfig[e].placeholder)," "),o(2),s("ngForOf",i.formFieldsConfig[e].options)}}function Pt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(3).$implicit,i=p(2);s("ngClass",T(2,E,i.translate.currentLang==="ar")),o(),h(" ",i.getFieldError(e)," ")}}function It(r,t){if(r&1&&(l(0,"div",12)(1,"div",15),x(2,bt,2,12,"input",27)(3,yt,2,9,"input",28)(4,Ct,2,9,"input",29)(5,Ft,8,8,"div",30)(6,St,9,12,"div",31),c(),l(7,"div",17),x(8,Pt,2,4,"span",18),c()()),r&2){let e=p(2).$implicit,i=p(2);o(2),s("ngIf",i.formFieldsConfig[e].type!=="select"&&i.formFieldsConfig[e].type!=="textarea"&&i.formFieldsConfig[e].type!=="file"&&!D(6,_t).includes(e)),o(),s("ngIf",e==="car_price"),o(),s("ngIf",e==="jop_price"),o(),s("ngIf",i.formFieldsConfig[e].type==="file"),o(),s("ngIf",i.formFieldsConfig[e].type==="select"),o(2),s("ngIf",i.getFieldError(e))}}function Mt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(5);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("custom_jop_title")," ")}}function Ot(r,t){if(r&1&&(l(0,"div",12)(1,"div",15),C(2,"input",48),g(3,"translate"),c(),l(4,"div",17),x(5,Mt,2,4,"span",18),c()()),r&2){let e=p(4);o(2),w("error",e.isFieldInvalid("custom_jop_title")),s("placeholder",f(3,5,e.formFieldsConfig.custom_jop_title.placeholder))("ngClass",S(7,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("custom_jop_title"))}}function Tt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(5);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("custom_car_brand_id")," ")}}function Et(r,t){if(r&1&&(l(0,"div",12)(1,"div",15),C(2,"input",49),g(3,"translate"),c(),l(4,"div",17),x(5,Tt,2,4,"span",18),c()()),r&2){let e=p(4);o(2),w("error",e.isFieldInvalid("custom_car_brand_id")),s("placeholder",f(3,5,e.formFieldsConfig.custom_car_brand_id.placeholder))("ngClass",S(7,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("custom_car_brand_id"))}}function jt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(5);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("custom_car_model_id")," ")}}function Nt(r,t){if(r&1&&(l(0,"div",12)(1,"div",15),C(2,"input",50),g(3,"translate"),c(),l(4,"div",17),x(5,jt,2,4,"span",18),c()()),r&2){let e=p(4);o(2),w("error",e.isFieldInvalid("custom_car_model_id")),s("placeholder",f(3,5,e.formFieldsConfig.custom_car_model_id.placeholder))("ngClass",S(7,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(3),s("ngIf",e.getFieldError("custom_car_model_id"))}}function Lt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(5);s("ngClass",T(2,E,e.translate.currentLang==="ar")),o(),h(" ",e.getFieldError("selectedPolicy")," ")}}function kt(r,t){if(r&1){let e=I();l(0,"div",51)(1,"div",51)(2,"app-custome-drop-menu",52),F("selected",function(n){b(e);let a=p(4);return y(a.onSelect(n))})("manualPolicyAdd",function(){b(e);let n=p(4);return y(n.onManualPolicyAdd())}),c()(),l(3,"div",17),x(4,Lt,2,4,"span",18),c()()}if(r&2){let e=p(4);o(2),s("options",e.dropdownOptions)("isLoading",e.isLoadingPolicies),o(2),s("ngIf",e.getFieldError("selectedPolicy"))}}function Dt(r,t){if(r&1&&(l(0,"span",22),u(1),c()),r&2){let e=p(3).$implicit,i=p(2);s("ngClass",T(2,E,i.translate.currentLang==="ar")),o(),h(" ",i.getFieldError(e)," ")}}function Vt(r,t){if(r&1&&(l(0,"div",51)(1,"div",51),C(2,"textarea",53),g(3,"translate"),c(),l(4,"div",17),x(5,Dt,2,4,"span",18),c()()),r&2){let e=p(2).$implicit,i=p(2);o(2),w("error",i.isFieldInvalid(e)),s("id",e)("formControlName",e)("placeholder",f(3,7,i.formFieldsConfig[e].placeholder))("ngClass",S(9,P,i.translate.currentLang==="ar",i.translate.currentLang==="en")),o(3),s("ngIf",i.getFieldError(e))}}function Bt(r,t){if(r&1&&(M(0),x(1,It,9,7,"div",25)(2,Ot,6,10,"div",25)(3,Et,6,10,"div",25)(4,Nt,6,10,"div",25)(5,kt,5,3,"div",26)(6,Vt,6,12,"div",26),O()),r&2){let e=p().$implicit,i=p(2);o(),s("ngIf",D(6,mt).includes(e)),o(),s("ngIf",e==="custom_jop_title"&&i.showCustomJobTitle),o(),s("ngIf",e==="custom_car_brand_id"&&i.showCustomCarBrandId),o(),s("ngIf",e==="custom_car_model_id"&&i.showCustomCarModelsId),o(),s("ngIf",e==="selectedPolicy"),o(),s("ngIf",e==="message"||e==="notes")}}function At(r,t){if(r&1&&(M(0),x(1,Bt,7,7,"ng-container",1),O()),r&2){let e=t.$implicit;o(),s("ngIf",!D(1,pt).includes(e))}}function $t(r,t){if(r&1&&(M(0),l(1,"div",12)(2,"div",13)(3,"p",14),u(4),g(5,"translate"),g(6,"translate"),c()()(),x(7,At,2,2,"ng-container",23),l(8,"button",24),u(9),g(10,"translate"),g(11,"translate"),c(),O()),r&2){let e=p();o(2),s("ngClass",S(13,P,e.translate.currentLang==="ar",e.translate.currentLang==="en")),o(2),h(" ",e.isManualPolicy?f(5,5,"pages.home_form.manual_policy_description"):f(6,7,"pages.home_form.policy_selection_description")," "),o(3),s("ngForOf",e.Object.keys(e.claimForm.controls)),o(),s("disabled",e.isLoadingSubmit),o(),h(" ",e.isLoadingSubmit?f(10,9,"pages.home_form.loading"):f(11,11,"pages.home_form.submit_button")," ")}}var Ke=class r{constructor(t,e,i,n,a,_,d,N,R,X,Z,j,Ht,Ut){this.fb=t;this.http=e;this.authStorage=i;this.authService=n;this.motorInsuranceService=a;this.medicalInsuranceService=_;this.buildingInsuranceService=d;this.jopPolicyService=N;this.router=R;this.translate=X;this.cdr=Z;this.alertService=j;this.languageService=Ht;this.platformId=Ut;this.claimForm=this.fb.group({fullName:["",[m.required,m.minLength(2)]],email:["",[m.required,m.email]],phoneNumber:["",[m.required,m.pattern(/^01[0125]\d{8}$/)]]}),this.languageSubscription=this.languageService.currentLanguage$.subscribe(We=>{this.updateDirection(We)})}userDataStatus={fullName:!1,email:!1,phoneNumber:!1};destroy$=new te;claimForm;currentStep=1;isManualPolicy=!1;dropdownOptions=[];isLoadingPolicies=!1;userPolicies=null;isLoadingNext=!1;isLoadingSubmit=!1;languageSubscription;Object=Object;baseUrl=we.BASE_URL;insuranceTypes=[{id:"car",name:"Car ",en_name:"Car ",ar_name:"\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0633\u064A\u0627\u0631\u0629",active:!0},{id:"medical",name:"Medical ",en_name:"Medical ",ar_name:"\u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0637\u0628\u064A",active:!1},{id:"property",name:"Property ",en_name:"Property ",ar_name:"\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062A",active:!1},{id:"jop",name:"Professional ",en_name:"Professional ",ar_name:"\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0648\u0638\u0627\u0626\u0641",active:!1}];carTypes=[];carBrands=[];carModels=[];showCustomCarModelsId=!1;carYears=[];showCustomCarBrandId=!1;motorInsurances=[];medicalInsurances=[];buildingTypes=[];buildingCountries=[];filteredBuildingCountries=[];buildingInsurances=[];showCustomJobTitle=!1;selectedMainIdFile=null;selectedSecondIdFile=null;jobTitleOptions=[{en:"Lawyers and legal consultants",ar:"\u0627\u0644\u0645\u062D\u0627\u0645\u0648\u0646 \u0648\u0627\u0644\u0645\u0633\u062A\u0634\u0627\u0631\u0648\u0646 \u0627\u0644\u0642\u0627\u0646\u0648\u0646\u064A\u0648\u0646"},{en:"Accountants and auditors",ar:"\u0627\u0644\u0645\u062D\u0627\u0633\u0628\u0648\u0646 \u0648\u0627\u0644\u0645\u0631\u0627\u062C\u0639\u0648\u0646"},{en:"Insurance brokers and agents",ar:"\u0648\u0633\u0637\u0627\u0621 \u0648\u0648\u0643\u0644\u0627\u0621 \u0627\u0644\u062A\u0623\u0645\u064A\u0646"},{en:"Doctors, dentists, and other medical professionals",ar:"\u0627\u0644\u0623\u0637\u0628\u0627\u0621 \u0648\u0623\u0637\u0628\u0627\u0621 \u0627\u0644\u0623\u0633\u0646\u0627\u0646 \u0648\u063A\u064A\u0631\u0647\u0645 \u0645\u0646 \u0627\u0644\u0645\u062A\u062E\u0635\u0635\u064A\u0646 \u0641\u064A \u0627\u0644\u0645\u062C\u0627\u0644 \u0627\u0644\u0637\u0628\u064A"},{en:"Engineers and architects",ar:"\u0627\u0644\u0645\u0647\u0646\u062F\u0633\u0648\u0646 \u0648\u0627\u0644\u0645\u0639\u0645\u0627\u0631\u064A\u0648\u0646"},{en:"IT consultants and software developers",ar:"\u0645\u0633\u062A\u0634\u0627\u0631\u0648 \u062A\u0643\u0646\u0648\u0644\u0648\u062C\u064A\u0627 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0648\u0645\u0637\u0648\u0631\u0648 \u0627\u0644\u0628\u0631\u0645\u062C\u064A\u0627\u062A"},{en:"Management and business consultants",ar:"\u0645\u0633\u062A\u0634\u0627\u0631\u0648 \u0627\u0644\u0625\u062F\u0627\u0631\u0629 \u0648\u0627\u0644\u0623\u0639\u0645\u0627\u0644"},{en:"Surveyors and valuers",ar:"\u0627\u0644\u0645\u0633\u0651\u0627\u062D\u0648\u0646 \u0648\u0627\u0644\u0645\u062B\u0645\u0646\u0648\u0646"},{en:"Media, marketing, and creative agencies providing professional services",ar:"\u0648\u0643\u0627\u0644\u0627\u062A \u0627\u0644\u0625\u0639\u0644\u0627\u0645 \u0648\u0627\u0644\u062A\u0633\u0648\u064A\u0642 \u0648\u0627\u0644\u0625\u0628\u062F\u0627\u0639 \u0627\u0644\u062A\u064A \u062A\u0642\u062F\u0645 \u062E\u062F\u0645\u0627\u062A \u0645\u0647\u0646\u064A\u0629"},{en:"Others",ar:"\u0622\u062E\u0631\u0648\u0646"}];isClaim=!0;formFieldsConfig={fullName:{type:"text",placeholder:"pages.home_form.fields.fullName"},email:{type:"email",placeholder:"pages.home_form.fields.email"},phoneNumber:{type:"tel",placeholder:"pages.home_form.fields.phoneNumber"},selectedPolicy:{type:"dropdown",placeholder:"pages.home_form.fields.selectedPolicy"},message:{type:"textarea",placeholder:"pages.home_form.fields.message"},birthdate:{type:"date",placeholder:"pages.home_form.fields.birthdate"},gender:{type:"select",placeholder:"pages.home_form.fields.gender",options:[{value:"male",label:"pages.home_form.options.male"},{value:"female",label:"pages.home_form.options.female"}]},insurancePolicyNumber:{type:"text",placeholder:"pages.home_form.fields.insurancePolicyNumber"},notes:{type:"textarea",placeholder:"pages.home_form.fields.notes"},car_type_id:{type:"select",placeholder:"pages.home_form.fields.car_type_id"},car_brand_id:{type:"select",placeholder:"pages.home_form.fields.car_brand_id"},custom_car_brand_id:{type:"select",placeholder:"pages.home_form.fields.custom_car_brand_id"},car_model_id:{type:"select",placeholder:"pages.home_form.fields.car_model_id"},custom_car_model_id:{type:"select",placeholder:"pages.home_form.fields.custom_car_model_id"},car_year:{type:"select",placeholder:"pages.home_form.fields.car_year"},car_price:{type:"number",placeholder:"pages.home_form.fields.car_price"},motor_insurance_id:{type:"select",placeholder:"pages.home_form.fields.motor_insurance_id"},medical_insurance_id:{type:"select",placeholder:"pages.home_form.fields.medical_insurance_id"},building_type_id:{type:"select",placeholder:"pages.home_form.fields.building_type_id"},building_country_id:{type:"select",placeholder:"pages.home_form.fields.building_country_id"},building_price:{type:"number",placeholder:"pages.home_form.fields.building_price"},building_insurance_id:{type:"select",placeholder:"pages.home_form.fields.building_insurance_id"},jop_title:{type:"select",placeholder:"pages.home_form.fields.jop_title"},custom_jop_title:{type:"text",placeholder:"pages.home_form.fields.custom_jop_title"},jop_price:{type:"number",placeholder:"pages.home_form.fields.jop_price"},jop_main_id:{type:"file",placeholder:"pages.home_form.fields.jop_main_id"},jop_second_id:{type:"file",placeholder:"pages.home_form.fields.jop_second_id"}};categoryIds={medical:1,car:2,property:3,jop:5};ngOnInit(){this.insuranceTypes.find(e=>e.active)||(this.insuranceTypes[0].active=!0),this.currentStep=1,this.prefillUserData()}updateDirection(t){fe(this.platformId)&&document.documentElement.setAttribute("dir",t==="ar"?"rtl":"ltr")}fetchUserPolicies(){let t=this.authStorage.getUserData()?.id;if(t){this.isLoadingPolicies=!0;let e=new he().set("type","all");return this.http.get(`${this.baseUrl}app-profile/userpolicy/${t}`,{params:e}).pipe(ne(i=>{this.userPolicies=i,this.fetchPolicyOptions(),this.isLoadingPolicies=!1}),Y(i=>(console.error("Error fetching user policies:",i),this.isLoadingPolicies=!1,J(null))))}return J(null)}prefillUserData(){if(typeof window<"u"&&this.authService.isAuthenticated()){let t=this.authStorage.getUserData();if(t){let{name:e,email:i,phone:n}=t;this.claimForm.patchValue({fullName:e,email:i,phoneNumber:n});let a=["fullName","email","phoneNumber"];this.userDataStatus={fullName:!!t.name,email:!!t.email,phoneNumber:!!t.phone},this.claimForm.markAllAsTouched()}}}selectInsuranceType(t){this.insuranceTypes.forEach(e=>{e.active=e.id===t.id}),this.isManualPolicy=!1,this.resetDropdownSelection(),this.updateFormFields(),this.fetchPolicyOptions()}resetDropdownSelection(){this.dropdownOptions=[],this.claimForm.get("selectedPolicy")?.patchValue("")}fetchPolicyOptions(){this.isLoadingPolicies=!0,this.dropdownOptions=[];let t=this.insuranceTypes.find(e=>e.active)?.id||"medical";if(this.userPolicies){let e=[];switch(t){case"medical":e=this.userPolicies.medical,this.dropdownOptions=e.map(i=>({title:i.name,code:i.medical_insurance_number,agreed:i.active_status==="confirmed",disabled:i.active_status!=="confirmed"}));break;case"car":e=this.userPolicies.motor,this.dropdownOptions=e.map(i=>({title:i.name,code:i.motor_insurance_number,agreed:i.active_status==="active",disabled:i.active_status!=="confirmed"}));break;case"property":e=this.userPolicies.building,this.dropdownOptions=e.map(i=>({title:i.name,code:i.building_insurance_number,agreed:i.active_status==="active",disabled:i.active_status!=="confirmed"}));break;case"jop":e=this.userPolicies.jop,this.dropdownOptions=e.map(i=>({title:i.name,code:i.jop_insurance_number,agreed:i.active_status==="confirmed",disabled:i.active_status!=="confirmed"}));break}this.isLoadingPolicies=!1}else this.isLoadingPolicies=!1}buildCarBrandOptions(){this.formFieldsConfig.car_brand_id.options=[...this.carBrands.map(t=>({value:t.id,label:this.translate.currentLang==="en"?t.en_title:t.ar_title}))]}updateFormFields(){let t=this.insuranceTypes.find(_=>_.active)?.id,e=this.claimForm.value,i=(_,d,N)=>{this.claimForm.get(_)?(this.claimForm.get(_)?.patchValue(d),this.claimForm.get(_)?.setValidators(N)):this.claimForm.addControl(_,this.fb.control(d,N)),this.claimForm.get(_)?.updateValueAndValidity()};if((_=>{_.forEach(d=>{this.claimForm.contains(d)&&this.claimForm.removeControl(d)})})(["selectedPolicy","message","birthdate","gender","insurancePolicyNumber","notes","status","category_id","user_id","medical_insurance_id","motor_insurance_id","building_insurance_id","car_type_id","car_brand_id","custom_car_brand_id","car_model_id","custom_car_model_id","car_year","car_price","building_type_id","building_country_id","building_price","jop_title","custom_jop_title","jop_price","jop_main_id","jop_second_id"]),this.currentStep===1)i("fullName",e.fullName||"",[m.required,m.minLength(2)]),i("email",e.email||"",[m.required,m.email]),i("phoneNumber",e.phoneNumber||"",[m.required,m.pattern(/^01[0125]\d{8}$/)]);else if(this.currentStep===2)if(i("fullName",e.fullName||"",[m.required,m.minLength(2)]),i("email",e.email||"",[m.required,m.email]),i("phoneNumber",e.phoneNumber||"",[m.required,m.pattern(/^01[0125]\d{8}$/)]),this.isManualPolicy)switch(i("insurancePolicyNumber",e.insurancePolicyNumber||"",[m.required,m.minLength(4)]),i("notes",e.notes||"",[m.required,m.minLength(10)]),i("status","REQUESTED",[m.required]),i("user_id",this.authStorage.getUserData()?.id||"",[m.required]),i("category_id",this.categoryIds[t],[m.required]),t){case"medical":i("birthdate",this.formatDateToYMD(e.birthdate)||"",[m.required,m.pattern(/^\d{4}-\d{2}-\d{2}$/)]),i("gender",e.gender||"",[m.required]),this.medicalInsuranceService.fetchMedicalData().subscribe({next:_=>{this.medicalInsurances=_.category.medicalinsurances.filter(d=>d.active_status==="1"),this.formFieldsConfig.medical_insurance_id.options=[...this.medicalInsurances.map(d=>({value:d.id,label:`${d.en_title} (${d.company_name} (${d.month_money} / ${d.year_money}))`}))]},error:_=>console.error("Error fetching medical data:",_)});break;case"car":i("car_type_id",e.car_type_id||"",[m.required]),i("car_brand_id",e.car_brand_id||"",[m.required]),i("custom_car_brand_id",e.custom_car_brand_id||"",[]),i("car_model_id",e.car_model_id||"",[m.required]),i("custom_car_model_id",e.custom_car_model_id||"",[]),i("car_year",e.car_year||"",[m.required,m.pattern(/^\d{4}$/)]),i("car_price",e.car_price||"",[m.required,m.pattern(/^[0-9]+$/),m.min(1e5)]),this.motorInsuranceService.fetchMotorData().subscribe({next:_=>{this.carTypes=_.types.filter(d=>d.active_status==="1"),this.carBrands=_.brands.filter(d=>d.active_status==="1"),this.carYears=_.years,this.motorInsurances=_.category.motorinsurances.filter(d=>d.active_status==="1"),this.formFieldsConfig.car_type_id.options=[...this.carTypes.map(d=>({value:d.id,label:d.en_title}))],this.buildCarBrandOptions(),this.translate.onLangChange.pipe(ie(this.destroy$)).subscribe({next:()=>{this.buildCarBrandOptions()}}),this.formFieldsConfig.car_year.options=[...this.carYears.map(d=>({value:d,label:d.toString()}))],this.formFieldsConfig.motor_insurance_id.options=[...this.motorInsurances.map(d=>({value:d.id,label:`${d.en_title} (${d.company_name} (${d.month_money} / ${d.year_money}))`}))],e.car_brand_id&&this.onCarBrandChange({target:{value:e.car_brand_id}})},error:_=>console.error("Error fetching motor data:",_)});break;case"property":i("building_type_id",e.building_type_id||"",[m.required]),i("building_country_id",e.building_country_id||"",[m.required]),i("building_price",e.building_price||"",[m.required,m.pattern(/^[0-9]+$/),m.min(5e5)]),this.buildingInsuranceService.fetchBuildingData().subscribe({next:_=>{this.buildingTypes=_.types.filter(d=>d.active_status==="1"),this.buildingCountries=_.countries.filter(d=>d.active_status==="1"),this.buildingInsurances=_.category.buildinginsurances.filter(d=>d.active_status==="1"),this.formFieldsConfig.building_type_id.options=[...this.buildingTypes.map(d=>({value:d.id,label:d.en_title}))],this.formFieldsConfig.building_country_id.options=[...this.buildingCountries.map(d=>({value:d.id,label:d.en_title}))],this.formFieldsConfig.building_insurance_id.options=[...this.buildingInsurances.map(d=>({value:d.id,label:`${d.en_title} (${d.company_name} (${d.month_money} / ${d.year_money}))`}))],e.building_type_id&&this.onBuildingTypeChange({target:{value:e.building_type_id}})},error:_=>console.error("Error fetching building data:",_)});break;case"jop":i("jop_title",e.jop_title||"",[m.required]),i("custom_jop_title",e.custom_jop_title||"",[]),i("jop_price",e.jop_price||"",[m.required,m.min(5e4),m.max(1e6)]),i("jop_main_id",e.jop_main_id||"",[m.required]),i("jop_second_id",e.jop_second_id||"",[]),this.formFieldsConfig.jop_title.options=this.jobTitleOptions.map(_=>({value:this.translate.currentLang==="ar"?_.ar:_.en,label:this.translate.currentLang==="ar"?_.ar:_.en}));break}else i("selectedPolicy",e.selectedPolicy||"",[m.required]),i("message",e.message||"",[m.required,m.minLength(10)]);this.claimForm.updateValueAndValidity(),this.claimForm.markAsUntouched()}onCarBrandChange(t){let e=+t.target.value;this.carModels=this.motorInsuranceService.getModelsByBrand(e),this.formFieldsConfig.car_model_id.options=[...this.carModels.map(a=>({value:a.id,label:a.en_title})),{value:"Others",label:this.translate.instant("pages.home_form.options.other")}];let i=t.target.value,n="15";this.showCustomCarBrandId=i===n,this.showCustomCarBrandId?this.claimForm.get("custom_car_brand_id")?.setValidators([m.required]):(this.claimForm.get("custom_car_brand_id")?.clearValidators(),this.claimForm.get("custom_car_brand_id")?.setValue("")),this.claimForm.get("custom_car_brand_id")?.updateValueAndValidity()}onCarModelChange(t){let e=t.target.value,i="Others";this.showCustomCarModelsId=e===i,this.showCustomCarBrandId?this.claimForm.get("custom_car_model_id")?.setValidators([m.required]):(this.claimForm.get("custom_car_model_id")?.clearValidators(),this.claimForm.get("custom_car_model_id")?.setValue("")),this.claimForm.get("custom_car_model_id")?.updateValueAndValidity()}onBuildingTypeChange(t){let e=+t.target.value;this.filteredBuildingCountries=this.buildingInsuranceService.getCountriesByType(e),this.claimForm.get("building_country_id")?.patchValue(""),this.formFieldsConfig.building_country_id.options=[...this.filteredBuildingCountries.map(i=>({value:i.id,label:i.en_title}))]}updateUserData(){if(Object.values(this.userDataStatus).some(t=>t===!1)&&this.authService.isAuthenticated()){let t=new FormData;t.append("user_id",String(this.authService?.getUserId())),Object.keys(this.userDataStatus).forEach(e=>{if(!this.userDataStatus[e]){let i=this.claimForm.get(e)?.value;i&&t.append(e,i)}}),this.authService.updateUserData(t).subscribe({next:e=>{let i=this.authService.getUserData(),n=ze(t);if(n={name:n.fullName,user_id:n.user_id},i){let a=G(G({},i),n);this.authStorage.saveUserData(a)}},error:e=>{console.log("error while updating user data after lead creation",e)}})}}onNextStep(){if(this.claimForm.markAllAsTouched(),["fullName","email","phoneNumber"].every(i=>this.claimForm.get(i)?.valid))if(this.isLoadingNext=!0,this.authStorage.isAuthenticated())this.fetchUserPolicies().subscribe({next:()=>{this.currentStep=2,this.updateFormFields(),this.isLoadingNext=!1},error:()=>{this.isLoadingNext=!1}}),this.updateUserData();else{let i={name:this.claimForm.value.fullName,email:this.claimForm.value.email,phone:this.claimForm.value.phoneNumber,password:"defaultPassword123"};this.authService.register(i).pipe(Y(n=>{console.error("Registration error:",n),this.isLoadingNext=!1;let a=this.translate.instant("pages.home_form.errors.registration_failed");return(n.status===422||n.status===400)&&n.error?.errors?(n.error.errors.email&&(a+=`
- ${this.translate.instant("pages.home_form.errors.email_exist")}`),n.error.errors.phone&&(a+=`
- ${this.translate.instant("pages.home_form.errors.phone_exist")}`),this.alertService.showGeneral({messages:[a+`
`],buttonLabel:this.translate.instant("pages.home_form.errors.login"),redirectRoute:`/${this.authService.getCurrentLang()}/login`})):alert(this.translate.instant("pages.home_form.errors.unexpected_error")),new ee(_=>_.error(n))})).subscribe({next:n=>{this.authStorage.saveUserData(n.user),this.claimForm.patchValue({user_id:n.user.id}),this.fetchUserPolicies().subscribe({next:()=>{this.currentStep=2,this.updateFormFields(),this.isLoadingNext=!1},error:()=>{this.isLoadingNext=!1}})}})}else this.markFormGroupTouched(),console.warn("Step 1 form is invalid. Please check the fields.")}onSelect(t){this.isManualPolicy=!1,this.claimForm.patchValue({selectedPolicy:t.code}),this.updateFormFields()}onManualPolicyAdd(){this.isManualPolicy=!0,this.claimForm.get("selectedPolicy")?.patchValue(""),this.updateFormFields()}onSubmit(){if(console.log("any"),this.claimForm.markAllAsTouched(),console.log(this.claimForm.value),this.claimForm.valid){this.isLoadingSubmit=!0;let t=this.claimForm.value,e=this.insuranceTypes.find(a=>a.active)?.id||"medical",i,n={name:t.fullName,email:t.email,phone:t.phoneNumber,user_id:t.user_id||this.authStorage.getUserData()?.id?.toString()||"",status:"requested",category_id:this.categoryIds[e].toString(),medical_insurance_id:t.medical_insurance_id,motor_insurance_id:t.motor_insurance_id,building_insurance_id:t.building_insurance_id};if(this.isManualPolicy)switch(n.description=t.notes,e){case"medical":n.birthdate=this.formatDateToYMD(t.birthdate),n.gender=t.gender,n.medical_insurance_number=t.insurancePolicyNumber,i=this.medicalInsuranceService.createMedicalClaim(n);break;case"car":let a="15",_="Others";n.car_type_id=t.car_type_id,n.car_brand_id=t.car_brand_id===a?null:t.car_brand_id,n.motor_insurance_number=t.insurancePolicyNumber;let d=this.carBrands.find(j=>j.id===+t.car_brand_id);d?n.car_brand=d.en_title:n.car_brand=t.custom_car_brand_id,n.car_model_id=t.car_model_id===_?null:t.car_model_id;let N=this.carModels.find(j=>j.id===+t.car_model_id);N?n.car_model=N.en_title:n.car_model=t.custom_car_model_id,n.car_year=t.car_year,n.car_price=t.car_price,i=this.motorInsuranceService.createMotorClaim(n);break;case"property":n.building_type_id=t.building_type_id,n.building_type=this.buildingTypes.find(j=>j.id===+t.building_type_id)?.en_title,n.building_country_id=t.building_country_id;let R=this.buildingCountries.find(j=>j.id===+t.building_country_id);R&&(n.building_country=R.en_title),n.building_price=t.building_price,n.building_insurance_number=t.insurancePolicyNumber,i=this.buildingInsuranceService.createBuildingClaim(n);break;case"jop":n.description=t.notes;let X=this.translate.currentLang==="ar"?"\u0622\u062E\u0631\u0648\u0646":"Others",Z=t.jop_title===X?t.custom_jop_title:t.jop_title;n.jop_title=Z,n.jop_price=t.jop_price,this.selectedMainIdFile&&(n.jop_main_id=this.selectedMainIdFile),this.selectedSecondIdFile&&(n.jop_second_id=this.selectedSecondIdFile),i=this.jopPolicyService.createJobClaim(this.createJobClaimFormData(n));break;default:console.error("Unknown active insurance type for manual submission."),alert(this.translate.instant("pages.home_form.errors.invalid_insurance_type")),this.isLoadingSubmit=!1;return}else{n.description=t.message;let a=this.userPolicies?(e==="medical"?this.userPolicies.medical:e==="car"?this.userPolicies.motor:this.userPolicies.building).find(d=>d[e==="car"?"motor_insurance_number":e==="property"?"building_insurance_number":"medical_insurance_number"]===t.selectedPolicy):null;if(a){console.log("Selected Policy:",a);let d=e==="car"?"motor":e==="property"?"building":"medical";n[`${d}_insurance_id`]=a[`${d}_insurance_id`],n[`${d}_insurance_number`]=a[`${d}_insurance_number`],n[`admin_${d}_insurance_number`]=a[`admin_${d}_insurance_number`],a.payment_method&&(n.payment_method=a.payment_method),e==="car"?(console.log("Adding car specific fields:",a),n.car_type_id=a.car_type_id,n.car_type=a.car_type,n.car_brand_id=a.car_brand_id,n.car_brand=a.car_brand,n.car_model_id=a.car_model_id,n.car_model=a.car_model,n.car_year=a.car_year,n.car_price=a.car_price):e==="property"?(console.log("Adding property specific fields:",a),n.building_type_id=a.building_type_id,n.building_type=a.building_type,n.building_country_id=a.building_country_id,n.building_country=a.building_country,n.building_price=a.building_price,n.building_insurance_id=a.building_insurance_id):e==="medical"&&(console.log("Adding medical specific fields:",a),n.birthdate=this.formatDateToYMD(a.birthdate),n.gender=a.gender,n.medical_insurance_id=a.medical_insurance_id)}else console.warn("Selected policy not found in user policies");let _;switch(e){case"medical":_=`${this.baseUrl}app-claims/claim-medical-store`;break;case"car":_=`${this.baseUrl}app-claims/claim-motor-store`;break;case"property":_=`${this.baseUrl}app-claims/claim-building-store`;break;default:console.error("Unknown active insurance type for non-manual submission."),alert(this.translate.instant("pages.home_form.errors.invalid_insurance_type")),this.isLoadingSubmit=!1;return}i=this.http.post(_,n)}i.subscribe({next:a=>{console.log("Form submitted successfully:",a),this.alertService.showGeneral({messages:[this.translate.instant("pages.home_form.success.claim_submitted")]}),this.resetForm(),this.isLoadingSubmit=!1,this.router.navigate([`/${this.authService.getCurrentLang()}/claims`])},error:a=>{console.error("Submission error:",a),this.alertService.showGeneral({messages:[this.translate.instant("pages.home_form.errors.submission_failed")],buttonLabel:this.translate.instant("pages.home_form.errors.login"),redirectRoute:`/${this.authService.getCurrentLang()}/login`}),this.isLoadingSubmit=!1},complete:()=>{setTimeout(()=>{this.alertService.hide()},2e3)}})}else{let t={};Object.keys(this.claimForm.controls).forEach(e=>{let i=this.claimForm.get(e);i?.invalid&&(t[e]={value:i.value,errors:i.errors})}),console.warn("Form is invalid. Invalid fields:",t),this.markFormGroupTouched(),console.warn("Form is invalid. Please check the fields.")}}resetForm(){this.claimForm.reset(),this.currentStep=1,this.isManualPolicy=!1,this.prefillUserData(),this.updateFormFields(),this.carTypes=[],this.carBrands=[],this.carModels=[],this.carYears=[],this.motorInsurances=[],this.medicalInsurances=[],this.buildingTypes=[],this.buildingCountries=[],this.filteredBuildingCountries=[],this.buildingInsurances=[]}markFormGroupTouched(){Object.keys(this.claimForm.controls).forEach(t=>{let e=this.claimForm.get(t);e?.markAsTouched(),e?.updateValueAndValidity()})}getFieldError(t){let e=this.claimForm.get(t);if(e?.errors&&e.touched){if(e.errors.required)return this.translate.instant(`pages.home_form.errors.${t}_required`);if(e.errors.email)return this.translate.instant("pages.home_form.errors.email_invalid");if(e.errors.minlength)return this.translate.instant(`pages.home_form.errors.${t}_minlength`,{length:e.errors.minlength.requiredLength});if(e.errors.pattern)return t==="phoneNumber"?this.translate.instant("pages.home_form.errors.phone_invalid"):t==="birthdate"?this.translate.instant("pages.home_form.errors.birthdate_invalid"):t==="car_year"?this.translate.instant("pages.home_form.errors.car_year_invalid"):t==="car_price"||t==="building_price"||t==="jop_price"?this.translate.instant("pages.home_form.errors.car_price_invalid"):this.translate.instant(`pages.home_form.errors.${t}_invalid`);if(e.errors.min&&t==="building_price")return this.translate.instant("pages.home_form.errors.price_min",{min:5e5});if(e.errors.min&&t==="car_price")return this.translate.instant("pages.home_form.errors.car_price_min",{min:1e5});if(e.errors.min&&t==="jop_price")return this.translate.instant("pages.home_form.errors.job_price_min",{min:5e4});if(e.errors.max&&t==="jop_price")return this.translate.instant("pages.home_form.errors.price_max",{max:1e6})}return""}getFieldDisplayName(t){return this.translate.instant(`pages.home_form.fields.${t}`)}isFieldInvalid(t){let e=this.claimForm.get(t);return!!(e?.invalid&&e?.touched)}onJobTitleChange(t){let e=t.target.value,i=this.translate.currentLang==="ar"?"\u0622\u062E\u0631\u0648\u0646":"Others";this.showCustomJobTitle=e===i,this.showCustomJobTitle?this.claimForm.get("custom_jop_title")?.setValidators([m.required,m.minLength(2)]):(this.claimForm.get("custom_jop_title")?.clearValidators(),this.claimForm.get("custom_jop_title")?.setValue("")),this.claimForm.get("custom_jop_title")?.updateValueAndValidity()}onMainIdFileSelect(t){let i=t.target.files?.[0];i&&(this.selectedMainIdFile=i,this.claimForm.get("jop_main_id")?.setValue(i.name),this.claimForm.get("jop_main_id")?.markAsTouched())}onSecondIdFileSelect(t){let i=t.target.files?.[0];i&&(this.selectedSecondIdFile=i,this.claimForm.get("jop_second_id")?.setValue(i.name))}triggerFileInput(t){document.getElementById(t)?.click()}createJobClaimFormData(t){let e=new FormData;return Object.keys(t).forEach(i=>{i!=="jop_main_id"&&i!=="jop_second_id"&&t[i]!==null&&t[i]!==void 0&&e.append(i,t[i].toString())}),t.jop_main_id instanceof File&&e.append("jop_main_id",t.jop_main_id),t.jop_second_id instanceof File&&e.append("jop_second_id",t.jop_second_id),e}ngOnDestroy(){this.languageSubscription&&this.languageSubscription.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}formatDateToYMD(t){if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;let e=t.split(/[-/]/);if(e.length===3){if(e[0].length===2&&e[2].length===4)return`${e[2]}-${e[1]}-${e[0]}`;if(e[0].length===4&&e[2].length===2)return`${e[0]}-${e[1]}-${e[2]}`}return t}preventNonNumeric(t){let e=["Backspace","Tab","ArrowLeft","ArrowRight","Delete"];!/[0-9]/.test(t.key)&&!e.includes(t.key)&&t.preventDefault()}preventNumbers(t){let e=t.key;!isNaN(Number(e))&&e!==" "&&t.preventDefault()}restrictToLetters(t){let e=t.target,i=e.value,n=i.replace(/[0-9]/g,"");i!==n&&(e.value=n,this.claimForm.get("fullName")?.setValue(n))}restrictToEgyptianPhone(t){let e=t.target,i=e.value;i=i.replace(/[^0-9]/g,""),i.length>11&&(i=i.slice(0,11)),/^(010|011|012|015)/.test(i)||(i=""),e.value=i,this.claimForm.get("phoneNumber")?.setValue(i)}RestirctToNumbers(t){let e=t.target,i=e.value,n=i.replace(/[^0-9]/g,"");i!==n&&(e.value=n,this.claimForm.get("phone")?.setValue(n))}static \u0275fac=function(e){return new(e||r)(v(Ae),v(xe),v(Fe),v(Se),v(Re),v(Ge),v(Je),v(Ye),v(be),v($),v(ue),v(Ce),v(ye),v(ae))};static \u0275cmp=k({type:r,selectors:[["app-home-form"]],inputs:{isClaim:"isClaim"},decls:13,vars:10,consts:[[1,"mt-22","mb-42"],[4,"ngIf"],[1,"insurance-claim-container","block","my-16","mb-32",3,"dir"],[1,"main-content"],[1,"images-section"],["loading","lazy","src","/assets/message_form/form.png",3,"ngClass","alt"],[1,"form-section"],[1,"insurance-types"],["class","insurance-type-btn","type","button",3,"active","click",4,"ngFor","ngForOf"],[1,"claim-form",3,"ngSubmit","formGroup"],[3,"headingText","showStartSvg","showEndSvg"],["type","button",1,"insurance-type-btn",3,"click"],[1,"form-group"],[1,"info-text",3,"ngClass"],[1,"text-gray-700","mb-4","about-text",2,"text-transform","none !important"],[1,"input-container"],["type","text","id","fullName","formControlName","fullName",1,"form-input",3,"input","readOnly","placeholder","ngClass"],[1,"error-container"],["class","error-message",3,"ngClass",4,"ngIf"],["type","tel","id","phoneNumber","formControlName","phoneNumber",1,"form-input",3,"input","readOnly","placeholder","ngClass"],["type","email","id","email","formControlName","email",1,"form-input",3,"readOnly","placeholder","ngClass"],["type","button",1,"submit-btn",3,"click","disabled"],[1,"error-message",3,"ngClass"],[4,"ngFor","ngForOf"],["type","submit",1,"submit-btn",3,"disabled"],["class","form-group",4,"ngIf"],["class","w-full",4,"ngIf"],["class","form-input",3,"type","id","formControlName","placeholder","error","ngClass",4,"ngIf"],["type","text","id","car_price","formControlName","car_price","class","form-input",3,"placeholder","error","ngClass","input",4,"ngIf"],["type","number","id","jop_price","formControlName","jop_price","class","form-input","min","50000","max","1000000","step","1000",3,"placeholder","error","ngClass",4,"ngIf"],["class","file-upload-container",4,"ngIf"],["class","relative",4,"ngIf"],[1,"form-input",3,"type","id","formControlName","placeholder","ngClass"],["type","text","id","car_price","formControlName","car_price",1,"form-input",3,"input","placeholder","ngClass"],["type","number","id","jop_price","formControlName","jop_price","min","50000","max","1000000","step","1000",1,"form-input",3,"placeholder","ngClass"],[1,"file-upload-container"],["type","file","accept","image/*,.pdf,.doc,.docx",1,"hidden",3,"change","id"],["type","button",1,"w-full","px-4","py-3","border-2","border-dashed","border-gray-300","rounded-lg","text-gray-600","hover:border-blue-500","hover:text-blue-500","transition-all","duration-300","flex","items-center","justify-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"relative"],[1,"form-input","appearance-none","pr-10",3,"change","id","formControlName","ngClass"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"pointer-events-none","absolute","inset-y-0","end-8","flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-600"],["fill-rule","evenodd","d","M5.23 7.21a.75.75 0 011.06.02L10 11.293l3.71-4.06a.75.75 0 111.08 1.04l-4.25 4.65a.75.75 0 01-1.08 0l-4.25-4.65a.75.75 0 01.02-1.06z","clip-rule","evenodd"],[3,"value"],["type","text","id","custom_jop_title","formControlName","custom_jop_title",1,"form-input",3,"placeholder","ngClass"],["type","text","id","custom_car_brand_id","formControlName","custom_car_brand_id",1,"form-input",3,"placeholder","ngClass"],["type","text","id","custom_car_model_id","formControlName","custom_car_model_id",1,"form-input",3,"placeholder","ngClass"],[1,"w-full"],[3,"selected","manualPolicyAdd","options","isLoading"],["rows","5",1,"form-textarea",3,"id","formControlName","placeholder","ngClass"]],template:function(e,i){e&1&&(l(0,"div",0),x(1,ut,3,5,"ng-container",1),l(2,"div",2)(3,"div",3)(4,"div",4),C(5,"img",5),g(6,"translate"),c(),l(7,"div",6)(8,"div",7),x(9,gt,3,6,"button",8),c(),l(10,"form",9),F("ngSubmit",function(){return i.onSubmit()}),x(11,vt,28,46,"ng-container",1)(12,$t,12,16,"ng-container",1),c()()()()()),e&2&&(o(),s("ngIf",i.isClaim),o(),s("dir",i.translate.currentLang==="ar"?"rtl":"ltr"),o(3),se("alt",f(6,8,"pages.home_form.images_alt")),s("ngClass",i.translate.currentLang==="ar"?"scale-x-[-1]":""),o(4),s("ngForOf",i.insuranceTypes),o(),s("formGroup",i.claimForm),o(),s("ngIf",i.currentStep===1),o(),s("ngIf",i.currentStep===2))},dependencies:[A,ge,V,B,He,Te,ke,De,Ie,Ee,Le,q,Me,Be,Ve,je,Ne,ve,z,U,H,qe,Ue],styles:[".insurance-claim-container[_ngcontent-%COMP%]{margin:0 auto;font-family:Alexandria,sans-serif;background:#fff;width:100%;max-width:1200px;max-height:100vh}input[readonly][_ngcontent-%COMP%]{background-color:#f5f5f5;cursor:not-allowed;color:#888}.main-content[_ngcontent-%COMP%]{display:flex;align-items:start;gap:clamp(12px,1.5vw,24px)}.images-section[_ngcontent-%COMP%]{display:flex;max-width:35%;justify-content:start;margin-inline-end:clamp(-30px,-3vw,-60px);z-index:20}.main-image[_ngcontent-%COMP%]{max-width:100%;height:auto;border-radius:clamp(8px,1vw,12px)}@media (max-width: 1024px){.images-section[_ngcontent-%COMP%]{max-width:100%;height:auto;border-radius:clamp(8px,1vw,12px);display:none}}.form-section[_ngcontent-%COMP%]{position:relative;flex:1;flex-grow:1}.insurance-types[_ngcontent-%COMP%]{display:flex;gap:clamp(6px,.75vw,12px);justify-content:center;position:absolute;top:clamp(16px,2vw,26px);left:50%;transform:translate(-50%);width:100%;padding:clamp(6px,1vw,12px) 0;z-index:1}.about-text[_ngcontent-%COMP%]{color:#174a77;font-family:Alexandria;font-size:clamp(16px,2.5vw,23px);font-style:normal;font-weight:400;line-height:30px;text-transform:capitalize}.insurance-type-btn[_ngcontent-%COMP%]{color:#fff;background-color:#0c4a6e;border-radius:50px;padding:clamp(6px,1vw,10px) clamp(12px,2vw,20px);font-size:clamp(14px,2vw,23px);font-weight:400;cursor:pointer;transition:all .2s ease;min-width:clamp(80px,10vw,120px);text-transform:capitalize;box-shadow:0 2px 8px #0000001a}.insurance-type-btn[_ngcontent-%COMP%]:hover{background:#0c4a6e;color:#fff;transform:translateY(-2px)}.insurance-type-btn.active[_ngcontent-%COMP%]{background:#38bdf8;border-color:#38bdf8;color:#fff;box-shadow:0 4px 12px #38bdf84d}.claim-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:clamp(8px,1vw,12px);margin-top:clamp(30px,5vw,60px);padding:clamp(35px,6vw,70px) clamp(50px,8vw,100px);background:var(--color-bage);height:700px;overflow-y:auto;position:relative;overflow-x:hidden}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-container[_ngcontent-%COMP%]{position:relative;width:100%}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;height:clamp(50px,6vw,73px);background:#fff;border-radius:clamp(20px,3vw,30px);padding:0 clamp(16px,2.5vw,32px);font-size:clamp(16px,2.5vw,23px);color:#1f2937;transition:all .2s ease;resize:none!important}textarea[_ngcontent-%COMP%]{resize:none!important}.form-input[_ngcontent-%COMP%]::placeholder, .form-textarea[_ngcontent-%COMP%]::placeholder{color:#6b7280}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#38bdf8;box-shadow:0 0 8px #38bdf833}.form-input.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%]{border-color:#ef4444}.form-textarea[_ngcontent-%COMP%]{height:100px;padding:clamp(16px,2.5vw,32px);resize:vertical;min-height:clamp(120px,15vw,170px)}.error-container[_ngcontent-%COMP%]{min-height:clamp(16px,2vw,25px);font-size:clamp(10px,1vw,12px);color:#ef4444;margin-top:clamp(2px,.5vw,4px);padding:clamp(2px,.3vw,3px) clamp(16px,2.5vw,32px)}.error-message[_ngcontent-%COMP%]{display:block}.file-upload-section[_ngcontent-%COMP%]{margin:clamp(6px,1vw,12px) 0}.file-upload-label[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:clamp(4px,.5vw,8px);color:#38bdf8;font-size:clamp(14px,1.5vw,16px);font-weight:500;cursor:pointer}.file-upload-label[_ngcontent-%COMP%]:hover{color:#0ea5e9}.file-upload-label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:clamp(16px,1.5vw,20px);height:clamp(16px,1.5vw,20px)}.file-input[_ngcontent-%COMP%]{display:none}.selected-files[_ngcontent-%COMP%]{margin-top:clamp(4px,.5vw,8px);display:flex;flex-direction:column;gap:clamp(4px,.5vw,8px)}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f1f5f9;padding:clamp(4px,.5vw,8px) clamp(6px,1vw,12px);border-radius:clamp(4px,.5vw,8px);border:1px solid skyblue}.file-name[_ngcontent-%COMP%]{flex:1;font-size:clamp(12px,1.5vw,14px);color:#154876}.remove-file-btn[_ngcontent-%COMP%]{background:#ef4444;color:#fff;border:none;border-radius:50%;width:clamp(16px,1.5vw,20px);height:clamp(16px,1.5vw,20px);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:clamp(12px,1.5vw,14px)}.remove-file-btn[_ngcontent-%COMP%]:hover{background:#dc2626}.submit-btn[_ngcontent-%COMP%]{background:#37a6de;color:#fff;border:none;border-radius:clamp(20px,3vw,30px);padding:clamp(10px,1.5vw,14px) clamp(16px,2.5vw,32px);font-size:clamp(14px,1.5vw,16px);font-weight:400;cursor:pointer;transition:all .2s ease;align-self:flex-start;margin-top:auto;flex-shrink:0}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0ea5e9}.submit-btn[_ngcontent-%COMP%]:disabled{background:#37a6de;cursor:not-allowed}@media (max-width: 1024px){.main-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.claim-form[_ngcontent-%COMP%]{padding:50px 60px;height:450px}.images-section[_ngcontent-%COMP%]{margin-inline-end:0;justify-content:center}.form-section[_ngcontent-%COMP%]{width:100%}.insurance-types[_ngcontent-%COMP%]{gap:10px}.insurance-type-btn[_ngcontent-%COMP%]{padding:8px 16px;font-size:18px;min-width:100px}}@media (max-width: 768px){.insurance-claim-container[_ngcontent-%COMP%]{padding:12px}.images-section[_ngcontent-%COMP%]{display:none}.insurance-types[_ngcontent-%COMP%]{top:3px}.insurance-type-btn[_ngcontent-%COMP%]{padding:6px 12px;font-size:16px;min-width:90px}.claim-form[_ngcontent-%COMP%]{margin-top:40px;padding:40px 20px}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{height:50px;font-size:16px;padding:0 16px}.form-textarea[_ngcontent-%COMP%]{min-height:120px;padding:16px}.error-container[_ngcontent-%COMP%]{min-height:20px;font-size:10px;padding:2px 16px}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:12px 16px;font-size:14px}}@media (max-width: 480px){.insurance-type-btn[_ngcontent-%COMP%]{padding:5px 10px;font-size:14px;min-width:80px}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{height:40px;font-size:14px;padding:0 12px}.form-textarea[_ngcontent-%COMP%]{min-height:100px;padding:12px}.error-container[_ngcontent-%COMP%]{min-height:16px;font-size:9px}.file-upload-label[_ngcontent-%COMP%]{font-size:14px}}@media (prefers-contrast: high){.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{border:2px solid #000}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{border-color:#06c}.form-input.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%]{border-color:#c00}.insurance-type-btn[_ngcontent-%COMP%]{border:2px solid #000}.insurance-type-btn.active[_ngcontent-%COMP%]{background:#06c;border-color:#06c}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{transition:none!important}}@media print{.images-section[_ngcontent-%COMP%]{display:none}.insurance-claim-container[_ngcontent-%COMP%]{background:#fff}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{border:1px solid #000}}.insurance-claim-container[dir=rtl][_ngcontent-%COMP%]{text-align:right}.insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%], .insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]{direction:rtl}.insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{text-align:right}.insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .insurance-types[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}.insurance-claim-container[dir=rtl][_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{margin-left:auto;margin-right:1rem}"]})};export{Ke as a};
