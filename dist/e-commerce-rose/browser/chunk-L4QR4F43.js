import{a as J}from"./chunk-U65OUURT.js";import{b as j}from"./chunk-WTXMMYIH.js";import"./chunk-MJN5VWZP.js";import"./chunk-WLPYMJ5B.js";import{b as q,c as T,d as X,e as $,i as O,l as R,m as Y,u as z,w as H}from"./chunk-6G7SZGYW.js";import"./chunk-U6POVDGM.js";import{c as S,d as c,f as p,i as h,o as U}from"./chunk-QZHVMEMD.js";import{C as M,Da as w,Fa as y,Ga as x,Ia as B,Ma as u,R as _,Ra as r,Sa as o,Ta as E,Tb as V,Wa as I,Xa as b,Ya as g,Z as P,_ as C,eb as m,fb as f,gb as F,ja as v,lc as L,ta as n,tb as l,tc as N,ub as d,uc as D,vc as G,ya as A}from"./chunk-XFMLYWXN.js";function Q(e,s){e&1&&(r(0,"div",3),E(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",9),r(5,"div",10),E(6,"div",11)(7,"div",11),o()()),e&2&&x("@skeletonAnimation",void 0)}function W(e,s){if(e&1&&(r(0,"div",14),m(1),o()),e&2){let t=g(2);n(),f(t.errorMessage())}}function Z(e,s){if(e&1&&(r(0,"div",15),m(1),o()),e&2){let t=g(2);n(),f(t.successMessage())}}function ee(e,s){e&1&&(r(0,"span",23),m(1),l(2,"translate"),o()),e&2&&(n(),f(d(2,1,"pages.edit-password.errors.new-password-required")))}function te(e,s){e&1&&(r(0,"span",23),m(1),l(2,"translate"),o()),e&2&&(n(),f(d(2,1,"pages.edit-password.errors.new-password-minlength")))}function ie(e,s){if(e&1&&w(0,ee,3,3,"span",23)(1,te,3,3,"span",23),e&2){let t,a=g(2);u((t=a.passwordForm.get("newPassword"))!=null&&t.hasError("required")?0:(t=a.passwordForm.get("newPassword"))!=null&&t.hasError("minlength")?1:-1)}}function ae(e,s){e&1&&(r(0,"span",23),m(1),l(2,"translate"),o()),e&2&&(n(),f(d(2,1,"pages.edit-password.errors.confirm-password-required")))}function ne(e,s){e&1&&(r(0,"span",23),m(1),l(2,"translate"),o()),e&2&&(n(),f(d(2,1,"pages.edit-password.errors.password-mismatch")))}function se(e,s){if(e&1&&w(0,ae,3,3,"span",23)(1,ne,3,3,"span",23),e&2){let t,a=g(2);u((t=a.passwordForm.get("confirmPassword"))!=null&&t.hasError("required")?0:(t=a.passwordForm.get("confirmPassword"))!=null&&t.hasError("passwordMismatch")?1:-1)}}function re(e,s){e&1&&(r(0,"span"),m(1),l(2,"translate"),o()),e&2&&(n(),f(d(2,1,"pages.edit-password.updating")))}function oe(e,s){e&1&&(m(0),l(1,"translate")),e&2&&F(" ",d(1,1,"pages.edit-password.update-password")," ")}function le(e,s){if(e&1){let t=I();r(0,"form",12),l(1,"translate"),b("ngSubmit",function(){P(t);let i=g();return C(i.onPasswordSubmit())}),r(2,"h2",13),m(3),l(4,"translate"),o(),w(5,W,2,1,"div",14)(6,Z,2,1,"div",15),r(7,"div",16)(8,"div")(9,"input",17),l(10,"translate"),b("focus",function(){let i;P(t);let k=g();return C((i=k.passwordForm.get("newPassword"))==null?null:i.markAsTouched())}),o()(),r(11,"div",18),w(12,ie,2,1),o()(),r(13,"div",16)(14,"div")(15,"input",19),l(16,"translate"),b("focus",function(){let i;P(t);let k=g();return C((i=k.passwordForm.get("confirmPassword"))==null?null:i.markAsTouched())}),o()(),r(17,"div",18),w(18,se,2,1),o()(),r(19,"div",20)(20,"button",21),l(21,"translate"),w(22,re,3,3,"span")(23,oe,2,3),o(),r(24,"button",22),l(25,"translate"),b("click",function(){P(t);let i=g();return C(i.goBackToProfile())}),m(26),l(27,"translate"),o()()()}if(e&2){let t,a,i=g();x("formGroup",i.passwordForm)("@formAnimation",void 0)("@shake",i.shakeState()),y("aria-label",d(1,18,"pages.edit-password.form-aria-label")),n(3),f(d(4,20,"pages.edit-password.header")),n(2),u(i.errorMessage()?5:-1),n(),u(i.successMessage()?6:-1),n(3),x("placeholder",d(10,22,"pages.edit-password.new-password-placeholder")),n(3),u((t=i.passwordForm.get("newPassword"))!=null&&t.touched&&((t=i.passwordForm.get("newPassword"))!=null&&t.invalid)?12:-1),n(3),x("placeholder",d(16,24,"pages.edit-password.confirm-password-placeholder")),n(3),u((a=i.passwordForm.get("confirmPassword"))!=null&&a.touched&&((a=i.passwordForm.get("confirmPassword"))!=null&&a.invalid)?18:-1),n(2),B("opacity-50",i.isUpdating()),x("disabled",i.passwordForm.invalid||i.isUpdating()),y("aria-label",d(21,26,"pages.edit-password.submit-button-aria-label")),n(2),u(i.isUpdating()?22:23),n(2),y("aria-label",d(25,28,"pages.edit-password.back-to-profile-aria-label")),n(2),F(" ",d(27,30,"pages.edit-password.back-to-profile")," ")}}var K=class e{_fb=_(z);_profileService=_(J);_router=_(L);_languageService=_(U);_alertService=_(j);_translateService=_(N);currentLang$=this._languageService.currentLanguage$;passwordForm;isUpdating=v(!1);errorMessage=v(null);successMessage=v(null);isLoading=v(!0);shakeState=v("idle");formSubmitted=v(!1);constructor(){this.passwordForm=this._fb.group({newPassword:["",[T.required,T.minLength(6)]],confirmPassword:["",T.required]},{validator:this.passwordMatchValidator})}ngOnInit(){setTimeout(()=>{this.isLoading.set(!1)},1e3)}passwordMatchValidator(s){let t=s.get("newPassword")?.value,a=s.get("confirmPassword")?.value;return t===a?null:{passwordMismatch:!0}}onPasswordSubmit(){if(this.formSubmitted.set(!0),this.passwordForm.markAllAsTouched(),this.passwordForm.invalid){this.errorMessage.set(this._translateService.instant("pages.edit-password.errors.form-invalid")),this.triggerShakeAnimation(),this.clearMessagesAfterDelay();return}this.isUpdating.set(!0),this.errorMessage.set(null),this.successMessage.set(null);let s=this.passwordForm.get("newPassword")?.value;this._profileService.updatePassword({password:s}).subscribe({next:t=>{this.successMessage.set(this._translateService.instant("pages.edit-password.success.update")),this._alertService.showNotification({title:this._translateService.instant("pages.edit-password.success.update-title"),message:this._translateService.instant("pages.edit-password.success.update")}),this.isUpdating.set(!1),this.clearMessagesAfterDelay(),setTimeout(()=>{let a="";this.currentLang$.pipe(M(1)).subscribe(i=>a=i),this._router.navigate(["/",a,"profile"])},2e3)},error:t=>{console.error("Error updating password:",t),this.errorMessage.set(t.error?.message||this._translateService.instant("pages.edit-password.errors.update-failed")),this._alertService.showNotification({title:this._translateService.instant("pages.edit-password.errors.update-failed-title"),message:t.error?.message||this._translateService.instant("pages.edit-password.errors.update-failed")}),this.isUpdating.set(!1),this.triggerShakeAnimation(),this.clearMessagesAfterDelay()},complete:()=>{setTimeout(()=>{this._alertService.hide()},2e3)}})}goBackToProfile(){let s="";this.currentLang$.pipe(M(1)).subscribe(t=>s=t),this._router.navigate(["/",s,"profile"])}triggerShakeAnimation(){this.shakeState.set("shake"),setTimeout(()=>{this.shakeState.set("idle")},500)}clearMessagesAfterDelay(){setTimeout(()=>{this.errorMessage.set(null),this.successMessage.set(null)},5e3)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=A({type:e,selectors:[["app-edit-password-page"]],decls:8,vars:6,consts:[[1,"flex","overflow-hidden","flex-col","md:flex-row","gap-6","md:gap-12","py-12","w-full","max-w-7xl","mx-auto"],[1,"flex","px-4","flex-1","flex-col","gap-4","w-full","md:w-1/2","lg:w-1/3"],[1,"loader-container"],[1,"flex","flex-col","gap-4"],["novalidate","",3,"formGroup"],[1,"flex","flex-1","justify-center","items-start","w-full","md:w-1/2","lg:w-2/3"],["src","assets/profile/profile.jpg",1,"w-full","hidden","md:block","max-h-[577px]","object-cover","rounded-[30px]",3,"alt"],[1,"h-8","w-3/4","bg-gray-200","rounded","animate-pulse"],[1,"h-4","w-full","bg-gray-200","rounded","animate-pulse"],[1,"h-12","w-full","bg-gray-200","rounded-lg","animate-pulse"],[1,"flex","justify-between"],[1,"h-10","w-1/3","bg-gray-200","rounded-lg","animate-pulse"],["novalidate","",3,"ngSubmit","formGroup"],[1,"text-3xl","font-bold","text-gray-800","mb-6","text-center"],[1,"text-red-600","text-center","mb-4"],[1,"text-green-600","text-center","mb-4"],[1,"flex","flex-col","mb-2"],["formControlName","newPassword","type","password","id","newPassword",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-container"],["formControlName","confirmPassword","type","password","id","confirmPassword",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"flex","justify-between","items-center"],["type","submit",1,"general-btn",3,"disabled"],[1,"general-btn","!bg-gray-300","!text-gray-800",3,"click"],[1,"error-message"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),w(3,Q,8,1,"div",3)(4,le,28,32,"form",4),o()(),r(5,"div",5),E(6,"img",6),l(7,"translate"),o()()),t&2&&(n(3),u(a.isLoading()?3:-1),n(),u(a.isLoading()?-1:4),n(2),x("alt",d(7,4,"pages.edit-password.image_alt"))("@imageAnimation",void 0))},dependencies:[V,H,O,q,X,$,R,Y,G,D],encapsulation:2,data:{animation:[S("imageAnimation",[h(":enter",[p({opacity:0,transform:"scale(0.8)"}),c("700ms ease-out",p({opacity:1,transform:"scale(1)"}))])]),S("shake",[h("idle => shake",[c("50ms",p({transform:"translateX(-10px)"})),c("100ms",p({transform:"translateX(10px)"})),c("100ms",p({transform:"translateX(-10px)"})),c("100ms",p({transform:"translateX(10px)"})),c("50ms",p({transform:"translateX(0)"}))])]),S("skeletonAnimation",[h(":enter",[p({opacity:0}),c("300ms ease-in",p({opacity:1}))]),h(":leave",[c("300ms ease-out",p({opacity:0}))])]),S("formAnimation",[h(":enter",[p({opacity:0,transform:"translateY(10px)"}),c("500ms 300ms ease-in",p({opacity:1,transform:"translateY(0)"}))]),h(":leave",[c("300ms ease-out",p({opacity:0,transform:"translateY(10px)"}))])])]}})};export{K as EditPasswordPageComponent};
