import{a as W}from"./chunk-U65OUURT.js";import{b as $}from"./chunk-WTXMMYIH.js";import{e as R}from"./chunk-MJN5VWZP.js";import"./chunk-WLPYMJ5B.js";import{b as Y,d as q,e as H,l as z,m as J,u as K,w as Q}from"./chunk-6G7SZGYW.js";import"./chunk-U6POVDGM.js";import{c as k,d,f as p,i as x,o as X}from"./chunk-QZHVMEMD.js";import{$ as D,Da as b,Fa as w,Ga as c,Ia as T,Jb as B,Ma as y,Pb as I,R as u,Ra as a,Sa as o,Ta as g,Tb as N,Wa as F,Xa as P,Ya as m,Z as S,_ as C,aa as M,eb as v,fb as h,gb as A,ja as f,lc as U,mc as V,ob as E,ta as n,tb as l,tc as j,ub as s,uc as G,vc as O,ya as L}from"./chunk-XFMLYWXN.js";var ee=e=>["/",e,"profile","edit-password"];function te(e,r){e&1&&(a(0,"div",3),g(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",9)(5,"div",9)(6,"div",9),a(7,"div",10),g(8,"div",11)(9,"div",11),o()()),e&2&&c("@skeletonAnimation",void 0)}function ie(e,r){if(e&1&&(a(0,"div",30),v(1),o()),e&2){let t=m(2);n(),h(t.errorMessage())}}function ae(e,r){if(e&1&&(a(0,"div",31),v(1),o()),e&2){let t=m(2);n(),h(t.successMessage())}}function ne(e,r){e&1&&(a(0,"span",32),v(1),l(2,"translate"),o()),e&2&&(n(),h(s(2,1,"pages.profile.errors.name-required")))}function re(e,r){if(e&1&&b(0,ne,3,3,"span",32),e&2){let t,i=m(2);y((t=i.profileForm.get("name"))!=null&&t.hasError("required")?0:-1)}}function oe(e,r){e&1&&(a(0,"span"),v(1),l(2,"translate"),o()),e&2&&(n(),h(s(2,1,"pages.profile.deactivating")))}function le(e,r){e&1&&(v(0),l(1,"translate")),e&2&&A(" ",s(1,1,"pages.profile.deactivate-account")," ")}function se(e,r){if(e&1){let t=F();a(0,"div",12),l(1,"translate"),P("ngSubmit",function(){S(t);let _=m();return C(_.onProfileSubmit())}),a(2,"h2",13),v(3),l(4,"translate"),o(),b(5,ie,2,1,"div",14)(6,ae,2,1,"div",15),a(7,"div",16)(8,"div")(9,"input",17),l(10,"translate"),P("focus",function(){S(t);let _=m();return C(_.onNameFocus())}),o()(),a(11,"div",18),b(12,re,1,1),o()(),a(13,"div",16)(14,"div"),g(15,"input",19),l(16,"translate"),o()(),a(17,"div",16)(18,"div"),g(19,"input",20),l(20,"translate"),o()(),a(21,"div",16)(22,"div",21),g(23,"input",22),a(24,"a",23),l(25,"async"),l(26,"translate"),D(),a(27,"svg",24),g(28,"path",25)(29,"path",26),o()()()(),M(),a(30,"div",27)(31,"button",28),l(32,"translate"),P("click",function(){S(t);let _=m();return C(_.onDelete())}),a(33,"span"),v(34),l(35,"translate"),o()(),a(36,"button",29),l(37,"translate"),P("click",function(){S(t);let _=m();return C(_.onDeactivate())}),b(38,oe,3,3,"span")(39,le,2,3),o()()()}if(e&2){let t,i=m();c("formGroup",i.profileForm)("@formAnimation",void 0),w("aria-label",s(1,19,"pages.profile.form-aria-label")),n(3),h(s(4,21,"pages.profile.header")),n(2),c("ngIf",i.errorMessage()),n(),c("ngIf",i.successMessage()),n(3),c("placeholder",s(10,23,"pages.profile.name-placeholder")),n(3),y((t=i.profileForm.get("name"))!=null&&t.touched&&((t=i.profileForm.get("name"))!=null&&t.invalid)?12:-1),n(3),c("placeholder",s(16,25,"pages.profile.email-placeholder")),n(4),c("placeholder",s(20,27,"pages.profile.phone-placeholder")),n(5),c("routerLink",E(39,ee,s(25,29,i.currentLang$))),w("aria-label",s(26,31,"pages.profile.edit-password")),n(7),w("aria-label",s(32,33,"pages.profile.submit-button-aria-label")),n(3),h(s(35,35,"pages.profile.delete-account")),n(2),T("opacity-50",i.isDeactivating()),c("disabled",i.isDeactivating()),w("aria-label",s(37,37,"pages.profile.deactivate-account-aria-label")),n(2),y(i.isDeactivating()?38:39)}}var Z=class e{_fb=u(K);_profileService=u(W);_authService=u(R);_router=u(U);_languageService=u(X);_alertService=u($);_translateService=u(j);currentLang$=this._languageService.currentLanguage$;profileForm;userData=null;isLoading=f(!0);isSaving=f(!1);isDeactivating=f(!1);errorMessage=f(null);successMessage=f(null);shakeState=f("idle");formSubmitted=f(!1);ngOnInit(){this.initForm(),this.loadUserProfile()}initForm(){this.profileForm=this._fb.group({name:[{value:"",disabled:!0}],email:[{value:"",disabled:!0}],phone:[{value:"",disabled:!0}]})}loadUserProfile(){this.isLoading.set(!0),this.errorMessage.set(null),this._profileService.getUserData().subscribe({next:r=>{this.userData=r.user,this.profileForm.patchValue({name:this.userData.name,email:this.userData.email,phone:this.userData.phone}),this.isLoading.set(!1)},error:r=>{console.error("Error loading user profile:",r),this._alertService.showNotification({title:this._translateService.instant("pages.profile.errors.load-failed"),message:this._translateService.instant("pages.profile.errors.load-failed")}),this.isLoading.set(!1),this.triggerShakeAnimation()}})}onProfileSubmit(){}onDeactivate(){this._alertService.showConfirmation({messages:[this._translateService.instant("pages.profile.deactivate_alert.deactivate_this_account")],confirmText:this._translateService.instant("pages.profile.deactivate_alert.deactivate_btn"),cancelText:this._translateService.instant("common.cancel"),imagePath:"common/after-remove.webp",onConfirm:()=>{this.deactivateUser()}})}deactivateUser(){this.isDeactivating.set(!0),this.errorMessage.set(null),this.successMessage.set(null),this._profileService.deactivateUser({deactive_status:0}).subscribe({next:r=>{this.successMessage.set(this._translateService.instant("pages.profile.success.deactivate")),this.isDeactivating.set(!1),this._authService.logout();let t="";this.currentLang$.subscribe(i=>t=i),this._router.navigate(["/",t,"login"]),this.clearMessagesAfterDelay()},error:r=>{console.error("Error deactivating account:",r),this._alertService.showNotification({title:this._translateService.instant("pages.profile.errors.deactivate-failed"),message:this._translateService.instant("pages.profile.errors.deactivate-failed")}),this.isDeactivating.set(!1),this.triggerShakeAnimation(),this.clearMessagesAfterDelay()}})}onDelete(){this._alertService.showConfirmation({messages:[this._translateService.instant("pages.profile.delete_alert.delete_this_account")],confirmText:this._translateService.instant("pages.profile.delete_alert.delete_btn"),cancelText:this._translateService.instant("common.cancel"),imagePath:"common/after-remove.webp",onConfirm:()=>{this.deleteUser()}})}deleteUser(){this._profileService.deleteUser().pipe().subscribe({next:r=>{this.isDeactivating.set(!1),this._authService.logout();let t="";this.currentLang$.subscribe(i=>t=i),this._router.navigate(["/",t,"login"]),this.clearMessagesAfterDelay()}})}onNameFocus(){this.profileForm.get("name")?.markAsTouched()}triggerShakeAnimation(){this.shakeState.set("shake"),setTimeout(()=>{this.shakeState.set("idle")},500)}clearMessagesAfterDelay(){setTimeout(()=>{this.errorMessage.set(null),this.successMessage.set(null)},5e3)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=L({type:e,selectors:[["app-profile-page"]],decls:8,vars:6,consts:[[1,"flex","overflow-hidden","flex-col","md:flex-row","gap-6","md:gap-12","py-12","w-full","max-w-7xl","mx-auto"],[1,"flex","px-4","flex-1","flex-col","gap-4","w-full","md:w-1/2","lg:w-1/3"],[1,"loader-container"],[1,"flex","flex-col","gap-4"],["novalidate","",3,"formGroup"],[1,"flex","flex-1","justify-center","items-start","w-full","md:w-1/2","lg:w-2/3"],["src","assets/profile/profile.jpg",1,"w-full","hidden","md:block","max-h-[577px]","object-cover","rounded-[30px]",3,"alt"],[1,"h-8","w-3/4","bg-gray-200","rounded","animate-pulse"],[1,"h-4","w-full","bg-gray-200","rounded","animate-pulse"],[1,"h-12","w-full","bg-gray-200","rounded-lg","animate-pulse"],[1,"flex","justify-between"],[1,"h-10","w-1/3","bg-gray-200","rounded-lg","animate-pulse"],["novalidate","",3,"ngSubmit","formGroup"],[1,"text-3xl","font-bold","text-gray-800","mb-6","text-center"],["class","text-red-600 text-center mb-4",4,"ngIf"],["class","text-green-600 text-center mb-4",4,"ngIf"],[1,"flex","flex-col","mb-2"],["formControlName","name","type","text","id","name","readonly","",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","bg-gray-50","text-gray-600","cursor-not-allowed",3,"focus","placeholder"],[1,"error-container"],["formControlName","email","type","email","id","email","readonly","",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","bg-gray-50","text-gray-600","cursor-not-allowed",3,"placeholder"],["formControlName","phone","type","text","id","phone","readonly","",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","bg-gray-50","text-gray-600","cursor-not-allowed",3,"placeholder"],[1,"relative"],["type","password","id","password","value","********","readonly","",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","bg-gray-50","text-gray-600","cursor-not-allowed"],[1,"absolute","inset-y-0","end-0","flex","items-center","pe-6","text-blue-600","hover:text-blue-700",3,"routerLink"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M18.3786 8.4496L11.4638 15.3646C11.1846 15.6438 10.829 15.8341 10.4418 15.9116L7.5 16.4999L8.08835 13.5581C8.16578 13.171 8.35609 12.8153 8.63528 12.5361L15.5502 5.62117M18.3786 8.4496L19.7928 7.03538C20.1833 6.64486 20.1833 6.01169 19.7928 5.62117L18.3786 4.20696C17.9881 3.81643 17.3549 3.81643 16.9644 4.20696L15.5502 5.62117M18.3786 8.4496L15.5502 5.62117","stroke","black","stroke-linecap","round","stroke-linejoin","round"],["d","M5 20H19","stroke","black","stroke-linecap","round","stroke-linejoin","round"],[1,"flex","flex-col","gap-2","md:flex-row","justify-between","items-center"],[1,"general-btn","!bg-red-600",3,"click"],[1,"general-btn",3,"click","disabled"],[1,"text-red-600","text-center","mb-4"],[1,"text-green-600","text-center","mb-4"],[1,"error-message"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),b(3,te,10,1,"div",3)(4,se,40,41,"div",4),o()(),a(5,"div",5),g(6,"img",6),l(7,"translate"),o()()),t&2&&(n(3),y(i.isLoading()?3:-1),n(),y(i.isLoading()?-1:4),n(2),c("alt",s(7,4,"pages.auth.login.login-image_alt"))("@imageAnimation",void 0))},dependencies:[N,B,I,O,G,Q,Y,q,H,z,J,V],styles:[".animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}"],data:{animation:[k("imageAnimation",[x(":enter",[p({opacity:0,transform:"scale(0.8)"}),d("700ms ease-out",p({opacity:1,transform:"scale(1)"}))])]),k("shake",[x("idle => shake",[d("50ms",p({transform:"translateX(-10px)"})),d("100ms",p({transform:"translateX(10px)"})),d("100ms",p({transform:"translateX(-10px)"})),d("100ms",p({transform:"translateX(10px)"})),d("50ms",p({transform:"translateX(0)"}))])]),k("skeletonAnimation",[x(":enter",[p({opacity:0}),d("300ms ease-in",p({opacity:1}))]),x(":leave",[d("300ms ease-out",p({opacity:0}))])]),k("formAnimation",[x(":enter",[p({opacity:0,transform:"translateY(10px)"}),d("500ms 300ms ease-in",p({opacity:1,transform:"translateY(0)"}))]),x(":leave",[d("300ms ease-out",p({opacity:0,transform:"translateY(10px)"}))])])]}})};export{Z as ProfileComponent};
