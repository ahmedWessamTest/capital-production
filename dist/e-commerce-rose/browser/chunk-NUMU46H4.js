import{b as Z}from"./chunk-WTXMMYIH.js";import{e as U}from"./chunk-MJN5VWZP.js";import"./chunk-WLPYMJ5B.js";import{b as H,c as C,d as J,e as K,i as Q,l as W,m as ee,u as te,w as ie}from"./chunk-6G7SZGYW.js";import"./chunk-U6POVDGM.js";import{c as w,d as m,f as a,g as E,i as y,j as G,k as R,o as Y}from"./chunk-QZHVMEMD.js";import{Da as F,Fa as P,Ga as c,Ia as I,J as f,Ma as _,Pb as D,R as u,Ra as n,Sa as p,Ta as $,Tb as M,Xa as A,Ya as T,Za as B,eb as g,fb as x,gb as k,h as O,ja as v,lc as X,mc as j,ob as N,ta as r,tb as s,tc as V,ub as l,uc as z,vc as q,ya as L}from"./chunk-XFMLYWXN.js";var ne=e=>["/",e,"login"];function se(e,o){e&1&&(n(0,"span",6),g(1),s(2,"translate"),p()),e&2&&(r(),x(l(2,1,"pages.auth.forgot-password.errors.email-required")))}function le(e,o){e&1&&(n(0,"span",6),g(1),s(2,"translate"),p()),e&2&&(r(),x(l(2,1,"pages.auth.forgot-password.errors.email-invalid")))}function pe(e,o){if(e&1&&F(0,se,3,3,"span",6)(1,le,3,3,"span",6),e&2){let t,i=T();_((t=i.forgotPasswordForm.get("email"))!=null&&t.hasError("required")?0:(t=i.forgotPasswordForm.get("email"))!=null&&t.hasError("email")||(t=i.forgotPasswordForm.get("email"))!=null&&t.hasError("pattern")?1:-1)}}function me(e,o){if(e&1&&(n(0,"span",6),g(1),p()),e&2){let t=T();r(),x(t.serverError())}}function de(e,o){e&1&&(n(0,"span"),g(1),s(2,"translate"),p()),e&2&&(r(),x(l(2,1,"Loading")))}function ue(e,o){e&1&&(g(0),s(1,"translate")),e&2&&k(" ",l(1,1,"pages.auth.forgot-password.button")," ")}var re=class e{destroy$=new O;_fb=u(te);_authService=u(U);_router=u(X);_languageService=u(Y);_alertService=u(Z);_translateService=u(V);currentLang$=this._languageService.currentLanguage$;forgotPasswordForm;isLoading=v(!1);shakeState=v("idle");formSubmitted=v(!1);serverError=v("");ngOnInit(){this.initForm()}initForm(){this.forgotPasswordForm=this._fb.group({email:["",[C.required,C.email,C.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]]})}submition(){if(this.formSubmitted.set(!0),this.serverError.set(""),this.forgotPasswordForm.invalid){this.forgotPasswordForm.markAllAsTouched(),this.triggerShakeAnimation();return}this.isLoading.set(!0);let o=this.forgotPasswordForm.value.email;this._authService.sendOTp(o).pipe(f(this.destroy$)).subscribe({next:t=>{if(this.isLoading.set(!1),t.success&&t.success.includes("Successfully")){let i="";this.currentLang$.pipe(f(this.destroy$)).subscribe(b=>i=b);let d=this._translateService.instant("pages.auth.forgot-password.otp-title"),ae={message:this._translateService.instant("pages.auth.forgot-password.otp-message"),email:o,alertType:"OTP",onVerify:b=>{this._authService.verifyOtp({email:o,otp:b}).pipe(f(this.destroy$)).subscribe({next:h=>{if(!h.error||h.error==="Correct OTP."){let S="";this.currentLang$.pipe(f(this.destroy$)).subscribe(oe=>S=oe),this._authService.storeResetEmail(o),this._authService.storeResetOtp(b),this._alertService.hide(),this._router.navigate(["/",S,"reset-password"],{state:{alertConfig:{type:"NOTIFICATION",message:this._translateService.instant("pages.auth.success-message")}}})}else this._alertService.setVerificationResult(!1,h.error)},error:h=>{let S=h?.error?.message||this._translateService.instant("Invalid_OTP");this._alertService.setVerificationResult(!1,S)}})},onResend:()=>{this._authService.sendOTp(o).pipe(f(this.destroy$)).subscribe()}};this._alertService.showOtp(ae)}else this.serverError.set(t.error||"Failed to send OTP. Please try again."),this.triggerShakeAnimation()},error:t=>{this.isLoading.set(!1),this.serverError.set(t?.error?.message||"Failed to send OTP. Please try again."),this.triggerShakeAnimation()}})}onEmailFocus(){this.forgotPasswordForm.get("email")?.markAsTouched()}triggerShakeAnimation(){this.shakeState.set("shake"),setTimeout(()=>{this.shakeState.set("idle")},500)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=L({type:e,selectors:[["app-forgot-password"]],decls:23,vars:31,consts:[[1,"flex","md:p-4","flex-col","md:flex-row","gap-6","md:gap-12","py-12","w-full","max-w-7xl","mx-auto"],[1,"flex","px-4","flex-1","flex-col","gap-4","w-full","md:w-1/2","lg:w-1/3"],["novalidate","",3,"ngSubmit","formGroup"],[1,"flex","flex-col","mb-2"],["formControlName","email","type","email","id","email",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-container"],[1,"error-message"],[1,"flex","justify-between","items-center"],["type","submit",1,"general-btn","bg-blue-600","text-white","py-2","px-16","rounded-lg","hover:bg-blue-700","transition-colors",3,"disabled"],[1,"have-account","underline",3,"routerLink"],[1,"hidden","md:flex","flex-1","justify-center","items-start","w-full","md:w-1/2","lg:w-2/3"],["loading","eager","fetchpriority","high","src","assets/profile/profile.jpg",1,"w-full","max-h-[577px]","object-cover","rounded-[30px]",3,"alt"]],template:function(t,i){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"form",2),A("ngSubmit",function(){return i.submition()}),n(3,"div",3)(4,"div")(5,"input",4),s(6,"translate"),A("focus",function(){return i.onEmailFocus()}),p()(),n(7,"div",5),F(8,pe,2,1)(9,me,2,1,"span",6),p()(),n(10,"div",7)(11,"button",8),s(12,"translate"),F(13,de,3,3,"span")(14,ue,2,3),p(),n(15,"a",9),s(16,"async"),s(17,"translate"),g(18),s(19,"translate"),p()()()(),n(20,"div",10),$(21,"img",11),s(22,"translate"),p()()),t&2){let d;c("@formAnimation",void 0),r(2),c("formGroup",i.forgotPasswordForm)("@inputAnimation",void 0)("@shake",i.shakeState()),r(3),c("placeholder",l(6,17,"pages.auth.forgot-password.email-placeholder")),r(3),_((d=i.forgotPasswordForm.get("email"))!=null&&d.touched&&((d=i.forgotPasswordForm.get("email"))!=null&&d.invalid)?8:-1),r(),_(i.serverError()?9:-1),r(2),I("opacity-50",i.isLoading()),c("disabled",i.isLoading()),P("aria-label",l(12,19,"pages.auth.forgot-password.submit-button-aria-label")),r(2),_(i.isLoading()?13:14),r(2),c("routerLink",N(29,ne,l(16,21,i.currentLang$))),P("aria-label",l(17,23,"pages.auth.forgot-password.back-to-login")),r(3),k(" ",l(19,25,"pages.auth.forgot-password.back-to-login")," "),r(3),B("alt",l(22,27,"pages.auth.forgot-password.image_alt")),c("@imageAnimation",void 0)}},dependencies:[M,D,q,z,ie,Q,H,J,K,W,ee,j],styles:[".have-account[_ngcontent-%COMP%]{color:#37a6de;font-family:Alexandria;font-size:clamp(16px,2.5vw,23px);font-style:normal;text-align:center;font-weight:500;line-height:1;text-decoration-line:underline;text-decoration-style:solid;text-decoration-skip-ink:auto;text-decoration-thickness:auto;text-underline-offset:auto;text-underline-position:from-font;text-transform:capitalize;transition:color .3s ease}.have-account[_ngcontent-%COMP%]:hover{color:#5db5df;text-decoration-thickness:2px}"],data:{animation:[w("formAnimation",[y(":enter",[a({opacity:0,transform:"translateY(20px)"}),m("500ms ease-out",a({opacity:1,transform:"translateY(0)"}))])]),w("inputAnimation",[y(":enter",[G("input, label, div, .error-container",[a({opacity:0,transform:"translateY(10px)"}),R(80,[m("400ms ease-out",a({opacity:1,transform:"translateY(0)"}))])],{optional:!0})])]),w("imageAnimation",[y(":enter",[a({opacity:0,transform:"scale(0.8)"}),m("700ms ease-out",a({opacity:1,transform:"scale(1)"}))])]),w("shake",[E("idle",a({transform:"translateX(0)"})),E("shake",a({transform:"translateX(0)"})),y("idle => shake",[m("50ms",a({transform:"translateX(-10px)"})),m("100ms",a({transform:"translateX(10px)"})),m("100ms",a({transform:"translateX(-10px)"})),m("100ms",a({transform:"translateX(10px)"})),m("50ms",a({transform:"translateX(0)"}))])])]}})};export{re as ForgetPasswordComponent};
