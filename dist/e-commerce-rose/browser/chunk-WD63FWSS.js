import{a as K}from"./chunk-7CBVHDBB.js";import{b as V}from"./chunk-WTXMMYIH.js";import{b as $,c as u,d as P,e as q,i as O,l as z,m as H,u as L,w as J}from"./chunk-6G7SZGYW.js";import{a as k}from"./chunk-U6POVDGM.js";import{$ as C,Da as f,Ga as p,J as S,Jb as M,Ra as a,Sa as r,Ta as g,Tb as D,Ua as w,Va as T,Wa as E,Xa as A,Z as b,_ as x,a as h,b as _,db as F,eb as l,gb as m,h as y,jc as U,lc as N,ta as t,tb as o,tc as j,ub as n,uc as R,vc as G,xa as d,xb as B,ya as I}from"./chunk-XFMLYWXN.js";function X(i,s){i&1&&(a(0,"p",11),l(1),o(2,"translate"),r()),i&2&&(t(),m(" ",n(2,1,"pages.add_emp_form.errors.name")," "))}function Y(i,s){i&1&&(a(0,"p",11),l(1),o(2,"translate"),r()),i&2&&(t(),m(" ",n(2,1,"pages.add_emp_form.errors.phone")," "))}function Z(i,s){i&1&&(a(0,"p",11),l(1),o(2,"translate"),r()),i&2&&(t(),m(" ",n(2,1,"pages.add_emp_form.errors.email")," "))}function ee(i,s){i&1&&(a(0,"p",11),l(1),o(2,"translate"),r()),i&2&&(t(),m(" ",n(2,1,"pages.add_emp_form.errors.exists")," "))}function te(i,s){i&1&&(w(0),l(1),o(2,"translate"),T()),i&2&&(t(),m(" ",n(2,1,"pages.add_emp_form.submit")," "))}function ie(i,s){i&1&&(C(),a(0,"svg",12),g(1,"circle",13)(2,"path",14),r(),l(3),o(4,"translate")),i&2&&(t(3),m(" ",n(4,1,"pages.add_emp_form.submitting")," "))}var Q=class i{constructor(s,c,e,v,W,re,oe){this.fb=s;this.route=c;this.router=e;this.CorporateDetailsService=v;this.authStorage=W;this.alertService=re;this.translate=oe}form;policyId;policyType;errorMessages=null;isSubmitting=!1;destroy$=new y;ngOnInit(){this.policyId=this.route.snapshot.paramMap.get("policyId"),this.policyType=this.route.snapshot.paramMap.get("policyType"),this.form=this.fb.group({name:["",[u.required,u.minLength(3)]],phone:["",[u.required,u.pattern(/^01(1|2|5|0)\d{8}$/)]],email:["",[u.required,u.email]]})}onSubmit(){if(this.form.invalid)return;this.errorMessages=null,this.isSubmitting=!0;let s="company-"+this.policyType,c=_(h({},this.form.value),{user_id:this.authStorage.getUserData()?.id.toString(),policy_id:this.policyId});this.CorporateDetailsService.submitCorporateUnit(s,c).pipe(S(this.destroy$)).subscribe({next:e=>{this.isSubmitting=!1,e.success&&(this.alertService.showNotification({title:this.translate.instant("common.success"),messages:[this.translate.instant("pages.add_emp_form.alert.emp_added_success")],confirmText:this.translate.instant("common.ok"),onDismiss:()=>this.alertService.hide()}),setTimeout(()=>{this.alertService.hide(),this.router.navigate(["../"],{relativeTo:this.route})},2e3))},error:e=>{this.isSubmitting=!1,console.error("Error in corporate unit form:",e),this.errorMessages=e?.error?.errors}})}get f(){return this.form.controls}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(c){return new(c||i)(d(L),d(U),d(N),d(K),d(k),d(V),d(j))};static \u0275cmp=I({type:i,selectors:[["app-add-corporate-unit-form"]],decls:31,vars:29,consts:[["loadingTpl",""],[1,"max-w-lg","mx-auto","bg-white","shadow-lg","rounded-2xl","p-6","mt-10"],[1,"text-2xl","font-semibold","text-gray-800","mb-6","text-center"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["formControlName","name","type","text",1,"w-full","px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"placeholder"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["formControlName","phone","type","text",1,"w-full","px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"placeholder"],["formControlName","email","type","email",1,"w-full","px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"placeholder"],["type","submit",1,"w-full","flex","items-center","justify-center","gap-2","bg-blue-600","text-white","py-2","px-4","rounded-lg","hover:bg-blue-700","transition","disabled:bg-gray-400",3,"disabled"],[4,"ngIf","ngIfElse"],[1,"text-red-500","text-sm","mt-1"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z",1,"opacity-75"]],template:function(c,e){if(c&1){let v=E();a(0,"div",1)(1,"h2",2),l(2),o(3,"translate"),r(),a(4,"form",3),A("ngSubmit",function(){return b(v),x(e.onSubmit())}),a(5,"div")(6,"label",4),l(7),o(8,"translate"),r(),g(9,"input",5),o(10,"translate"),f(11,X,3,3,"p",6),r(),a(12,"div")(13,"label",4),l(14),o(15,"translate"),r(),g(16,"input",7),o(17,"translate"),f(18,Y,3,3,"p",6),r(),a(19,"div")(20,"label",4),l(21),o(22,"translate"),r(),g(23,"input",8),o(24,"translate"),f(25,Z,3,3,"p",6),r(),f(26,ee,3,3,"p",6),a(27,"button",9),f(28,te,3,3,"ng-container",10)(29,ie,5,3,"ng-template",null,0,B),r()()()}if(c&2){let v=F(30);t(2),m(" ",n(3,15,"pages.add_emp_form.title")," "),t(2),p("formGroup",e.form),t(3),m(" ",n(8,17,"pages.add_emp_form.name")," "),t(2),p("placeholder",n(10,19,"pages.add_emp_form.Enter_employee_name")),t(2),p("ngIf",e.f.name.touched&&e.f.name.invalid),t(3),m(" ",n(15,21,"pages.add_emp_form.phone")," "),t(2),p("placeholder",n(17,23,"pages.add_emp_form.phone_placeholder")),t(2),p("ngIf",e.f.phone.touched&&e.f.phone.invalid),t(3),m(" ",n(22,25,"pages.add_emp_form.email")," "),t(2),p("placeholder",n(24,27,"pages.add_emp_form.email_placeholder")),t(2),p("ngIf",e.f.email.touched&&e.f.email.invalid),t(),p("ngIf",(e.errorMessages==null?null:e.errorMessages.phone)||(e.errorMessages==null?null:e.errorMessages.email)),t(),p("disabled",e.form.invalid||e.isSubmitting),t(),p("ngIf",!e.isSubmitting)("ngIfElse",v)}},dependencies:[J,O,$,P,q,z,H,D,M,G,R],encapsulation:2})};export{Q as AddCorporateUnitFormComponent};
