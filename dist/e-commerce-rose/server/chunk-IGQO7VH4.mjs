import './polyfills.server.mjs';
import{A as p,Dc as m,F as h,I as c,M as b,ad as u,b as o,ea as a,l as g}from"./chunk-UQC3G75Y.mjs";var d=class r{_http=b(m);baseUrl=u.BASE_URL;CACHE_EXPIRATION=5*60*1e3;blogsCache=a(new Map);singleBlogCache=a(new Map);cacheTimestamps=a(new Map);isBrowser(){return typeof window<"u"}getEnglishBlogs(t=1){if(!this.isBrowser())return new o(n=>n.complete());let e=`blogs-page-${t}`,s=this.blogsCache().get(t);return this.isCacheValid(e)&&s?g(s):this._http.get(`${this.baseUrl}app-blogs/getEnglishBlogs?page=${t}`).pipe(h(n=>{this.blogsCache.update(l=>new Map(l).set(t,n)),this.updateCacheTimestamp(e)}),p(1))}getSingleEnglishBlog(t){if(!this.isBrowser())return new o(n=>n.complete());let e=`blog-${t}`,s=this.singleBlogCache().get(e);return this.isCacheValid(e)&&s?g(s):this._http.get(`${this.baseUrl}app-blogs/getSingleEnglishBlogs/${t}`).pipe(h(n=>{this.singleBlogCache.update(l=>new Map(l).set(e,n)),this.updateCacheTimestamp(e)}),p(1))}invalidateCache(t){if(t.startsWith("blogs-page-")){let e=t.match(/blogs-page-(\d+)/);if(e){let s=parseInt(e[1],10);this.blogsCache.update(i=>{let n=new Map(i);return n.delete(s),n})}}else t.startsWith("blog-")&&this.singleBlogCache.update(e=>{let s=new Map(e);return s.delete(t),s});this.cacheTimestamps.update(e=>{let s=new Map(e);return s.delete(t),s})}clearBlogsCache(){this.blogsCache.set(new Map),this.cacheTimestamps.update(t=>{let e=new Map;for(let[s,i]of t.entries())s.startsWith("blogs-page-")||e.set(s,i);return e})}isCacheValid(t){let e=this.cacheTimestamps().get(t)||0;return e!==0&&Date.now()-e<this.CACHE_EXPIRATION}updateCacheTimestamp(t,e=Date.now()){this.cacheTimestamps.update(s=>new Map(s).set(t,e))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};export{d as a};
