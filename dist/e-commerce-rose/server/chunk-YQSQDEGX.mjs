import './polyfills.server.mjs';
import{e as ct}from"./chunk-D4LSP6XO.mjs";import"./chunk-7XZGEYGO.mjs";import{a as rt}from"./chunk-666L3XN7.mjs";import{c as it,d as I,f as T,g as E,i as P,o as lt}from"./chunk-VP43NVKH.mjs";import{$a as B,$c as ot,Aa as G,Ab as U,Dc as Z,E as C,Fa as y,I as k,M as u,Ma as _,Oa as A,Pa as x,Rc as tt,Sa as N,U as j,Ub as z,V as L,Va as F,W as p,Wa as $,X as h,Xa as a,Xc as et,Ya as o,Za as c,Zc as nt,_a as V,_c as at,ab as O,ad as st,bb as b,c as M,cb as g,dc as H,ea as v,ec as Y,fc as J,gc as K,hc as Q,ia as D,kb as s,lb as S,mb as d,oc as W,qc as X,tb as q,va as r,zb as R}from"./chunk-UQC3G75Y.mjs";import"./chunk-X2SEQXRR.mjs";var w=class n{_http=u(Z);_AuthStorageService=u(rt);baseUrl=st.BASE_URL;getNotifications(){let i={user_id:this._AuthStorageService.getUserData()?.id??0};return this._http.get(`${this.baseUrl}getNotificationLog`,{params:i})}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var ut=()=>[1,2,3],gt=(n,e)=>e.id;function pt(n,e){n&1&&(a(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10),c(4,"div",11)(5,"div",12),o(),c(6,"div",13),o(),c(7,"div",14)(8,"div",15),o()())}function _t(n,e){n&1&&(a(0,"div",4),y(1,pt,9,0,"div",6),o()),n&2&&(r(),_("ngForOf",q(1,ut)))}function ft(n,e){n&1&&(a(0,"div",16)(1,"div",17),p(),a(2,"svg",18),c(3,"path",19),o()(),h(),a(4,"p",20),s(5),R(6,"translate"),o()()),n&2&&(r(5),S(U(6,1,"pages.user_policies.no_data")))}function yt(n,e){if(n&1&&(a(0,"div",37),p(),a(1,"svg",38),c(2,"path",43),o(),h(),a(3,"span",40),s(4),o(),a(5,"span",41),s(6),o()()),n&2){let i=g().$implicit,t=g();r(4),d(" ",t.lang()==="ar"?"\u0631\u0642\u0645 \u0627\u0644\u0637\u0644\u0628":"claim number"," "),r(2),d(" ",t.getClaimNotificationNumber(i)," ")}}function vt(n,e){n&1&&(p(),a(0,"svg",49),c(1,"path",50),o())}function bt(n,e){n&1&&(p(),a(0,"svg",51),c(1,"path",52),o())}function ht(n,e){n&1&&(p(),a(0,"svg",53),c(1,"path",54),o())}function xt(n,e){n&1&&(p(),a(0,"svg",55),c(1,"circle",56),o())}function Nt(n,e){if(n&1&&(a(0,"div",37),V(1,44),y(2,vt,2,0,"svg",45)(3,bt,2,0,"svg",46)(4,ht,2,0,"svg",47)(5,xt,2,0,"svg",48),B(),a(6,"span",40),s(7),o(),a(8,"span",41),s(9),o()()),n&2){let i=g().$implicit,t=g();r(),_("ngSwitch",t.getStatus(i)),r(),_("ngSwitchCase","confirmed"),r(),_("ngSwitchCase","pending"),r(),_("ngSwitchCase","canceled"),r(3),d(" ",t.lang()==="ar"?"\u0627\u0644\u062D\u0627\u0644\u0647":"active status"," "),r(2),d(" ",t.lang()==="en"?t.getStatus(i):t.getArabicStatus(t.getStatus(i))," ")}}function wt(n,e){if(n&1){let i=O();a(0,"div",42)(1,"button",57),b("click",function(){j(i);let l=g().$implicit,m=g();return L(m.notificationRedirect(l))}),a(2,"span"),s(3),o(),p(),a(4,"svg",58),c(5,"path",59),o()()()}if(n&2){let i=g().$implicit,t=g();r(3),S(t.getNotificationLabel(i)),r(),A("rotate-180",t.lang()==="ar")}}function Ct(n,e){if(n&1&&(a(0,"div",5)(1,"div",21)(2,"div",22)(3,"div",23)(4,"div",24)(5,"div",25),c(6,"div",26),o()(),a(7,"div",27)(8,"h3",28),s(9),o()()(),a(10,"div",29)(11,"div",30),c(12,"img",31),o()()(),a(13,"div",32)(14,"h4",33),s(15),o()()(),a(16,"div",34)(17,"p",35),s(18),o()(),a(19,"div",36)(20,"div",37),p(),a(21,"svg",38),c(22,"path",39),o(),h(),a(23,"span",40),s(24),o(),a(25,"span",41),s(26),o()(),y(27,yt,7,2,"div",37)(28,Nt,10,6,"div",37),o(),y(29,wt,6,3,"div",42),o()),n&2){let i=e.$implicit,t=g();_("@fadeInOut","loaded"),r(9),d(" ",t.lang()==="ar"?i.ar_notification_title:i.notification_title," "),r(6),d(" ",t.getNotificationSubTitle(i)," "),r(3),d(" ",t.lang()==="ar"?i.ar_notification_text:i.notification_text," "),r(6),d(" ",t.lang()==="ar"?"\u0627\u0644\u062A\u0627\u0631\u064A\u062E":"Date"," "),r(2),d(" ",t.formatDisplayDate(i.created_at)," "),r(),N(t.activeTab()==="claims"?27:-1),r(),N(t.activeTab()!=="general"?28:-1),r(),N(t.activeTab()!=="general"&&(t.activeTab()==="policies"||t.activeTab()==="claims"&&!(!(i==null||i.notification_title==null)&&i.notification_title.includes("Update")))?29:-1)}}var dt=class n{destroy$=new M;activeTab=v("general");allNotifications=v({generalNotify:[],policyNotify:[],claimNotify:[]});isLoading=v(!0);lang=v("en");currentTabNotification=z(()=>{switch(this.activeTab()){case"policies":return this.allNotifications().policyNotify;case"claims":return this.allNotifications().claimNotify;default:return this.allNotifications().generalNotify}});notificationService=u(w);authService=u(ct);platformId=u(D);router=u(tt);_languageService=u(lt);translate=u(nt);currentLang$=this._languageService.currentLanguage$;ngOnInit(){if(X(this.platformId)){if(!this.authService.isAuthenticated()){this.router.navigate(["/",this._languageService.getCurrentLanguage()]);return}this.fetchNotifications()}this._languageService.currentLanguage$.pipe(C(this.destroy$)).subscribe(e=>{this.lang.set(e)})}fetchNotifications(){this.isLoading.set(!0),this.notificationService.getNotifications().pipe(C(this.destroy$)).subscribe({next:e=>{console.log("Notifications:",e),this.allNotifications.set(e),this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})}formatInputDate(e){if(!e)return null;let i=new Date(e);if(!isNaN(i.getTime()))return i;let t=e.split(/[-\/]/),l,m,f;if(t[0].length===4)[l,m,f]=t.map(Number);else if(t[2].length===4)[f,m,l]=t.map(Number);else return null;return isNaN(l)||isNaN(m)||isNaN(f)?null:(i=new Date(l,m-1,f),isNaN(i.getTime())?null:i)}formatDisplayDate(e){let i=this.formatInputDate(e);if(!i)return"N/A";let t=i.getDate().toString().padStart(2,"0"),l=i.toLocaleString(`${this.lang()==="ar"?"ar-EG":"en-US"}`,{month:"long"}),m=i.getFullYear();return`${t}, ${l} ${m}`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}notificationRedirect(e){let i=this.activeTab()==="policies"?e.policy:e.claim,t=e?.notification_title??"";this.activeTab()==="policies"?t.includes("New Comment!")?this.router.navigate(["/",this.lang(),"policies",i.id,e.request_type,"comments"]):this.router.navigate(["/",this.lang(),"policies",i.id,e.request_type]):this.router.navigate(["/",this.lang(),"claims",i.id,e.request_type,"comments"])}getNotificationLabel(e){let i=this.lang()==="ar",t=e?.notification_title??"";if(t.includes("New Comment!"))return i?"\u0627\u0630\u0647\u0628 \u0627\u0644\u064A \u0627\u0644\u062A\u0639\u0644\u064A\u0642\u0627\u062A":"Go to comments";if(t.includes("Update Alert!")){if(this.activeTab()==="policies")return i?"\u0627\u0630\u0647\u0628 \u0627\u0644\u064A \u0627\u0644\u0648\u062B\u064A\u0642\u0647":"Go to policy";if(this.activeTab()==="claims")return i?"\u0627\u0630\u0647\u0628 \u0627\u0644\u064A \u0627\u0644\u0645\u0637\u0627\u0644\u0628\u0647":"Go to claim"}return""}getStatus(e){return this.activeTab()==="policies"?e.policy.active_status:this.activeTab()==="claims"?e.claim.status:""}getArabicStatus(e){return e==="pending"?"\u0642\u064A\u062F \u0627\u0644\u0627\u0646\u062A\u0638\u0627\u0631":e==="confirmed"?"\u062A\u0645 \u0627\u0644\u0637\u0644\u0628":e==="canceled"?"\u062A\u0645 \u0627\u0644\u0625\u0644\u063A\u0627\u0621":e}getClaimNotificationNumber(e){return e.claim.claim_number}getNotificationSubTitle(e){let i=this.lang(),t=e?.notification_title?.includes("Update"),l;this.activeTab()==="policies"?l={medical:{update:["\u0648\u062B\u064A\u0642\u0629 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0637\u0628\u064A","New Medical Insurance Policy"],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0648\u062B\u064A\u0642\u0629 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0637\u0628\u064A","New Medical Insurance Policy Comment"]},job:{update:["\u0648\u062B\u064A\u0642\u0629 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0647\u0646\u064A","New Professional Indemnity Policy"],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0648\u062B\u064A\u0642\u0629 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0647\u0646\u064A","New Professional Indemnity Policy Comment"]},motor:{update:["\u0648\u062B\u064A\u0642\u0629 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0633\u064A\u0627\u0631\u0627\u062A","New Motor Insurance Policy"],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0648\u062B\u064A\u0642\u0629 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0633\u064A\u0627\u0631\u0627\u062A","New Motor Insurance Policy Comment"]},building:{update:["\u0648\u062B\u064A\u0642\u0629 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0645\u062A\u0644\u0643\u0627\u062A","New Property Insurance Policy"],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0648\u062B\u064A\u0642\u0629 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0645\u062A\u0644\u0643\u0627\u062A","New Property Insurance Policy Comment"]}}:l={medical:{update:["\u0645\u0637\u0627\u0644\u0628\u0647 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0637\u0628\u064A","New Medical Insurance Claim "],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0645\u0637\u0627\u0644\u0628\u0647 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0637\u0628\u064A","New Medical Insurance Claim  Comment"]},job:{update:["\u0645\u0637\u0627\u0644\u0628\u0647 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0647\u0646\u064A","New Professional Indemnity Claim "],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0645\u0637\u0627\u0644\u0628\u0647 \u0627\u0644\u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0647\u0646\u064A","New Professional Indemnity Claim  Comment"]},motor:{update:["\u0645\u0637\u0627\u0644\u0628\u0647 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0633\u064A\u0627\u0631\u0627\u062A","New Motor Insurance Claim "],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0645\u0637\u0627\u0644\u0628\u0647 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0633\u064A\u0627\u0631\u0627\u062A","New Motor Insurance Claim  Comment"]},building:{update:["\u0645\u0637\u0627\u0644\u0628\u0647 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0645\u062A\u0644\u0643\u0627\u062A","New Property Insurance Claim "],comment:["\u062A\u0639\u0644\u064A\u0642 \u0645\u0646 \u0645\u0637\u0627\u0644\u0628\u0647 \u062A\u0623\u0645\u064A\u0646 \u0627\u0644\u0645\u0645\u062A\u0644\u0643\u0627\u062A","New Property Insurance Claim  Comment"]}};let m=l[e.request_type];if(!m)return"";let f=t?m.update:m.comment;return i==="ar"?f[0]:f[1]}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=G({type:n,selectors:[["app-notifications"]],decls:12,vars:11,consts:[[1,"flex","gap-1","w-full","bg-gray-100","p-1","rounded-xl"],[3,"click"],["class","space-y-4 mt-6",4,"ngIf"],["class","text-center py-16",4,"ngIf"],[1,"space-y-4","mt-6"],[1,"bg-white","rounded-2xl","shadow-sm","border","border-gray-100","hover:shadow-md","hover:border-gray-200","transition-all","duration-300","overflow-hidden","group"],["class","bg-white rounded-2xl shadow-sm border border-gray-100 p-6",4,"ngFor","ngForOf"],[1,"bg-white","rounded-2xl","shadow-sm","border","border-gray-100","p-6"],[1,"animate-pulse"],[1,"flex","justify-between","items-start","mb-4"],[1,"flex","items-center","gap-3"],[1,"w-3","h-3","bg-gray-200","rounded-full"],[1,"h-4","bg-gray-200","rounded-lg","w-48"],[1,"w-20","h-12","bg-gray-200","rounded-lg"],[1,"h-4","bg-gray-200","rounded-lg","w-32","mb-4"],[1,"h-10","bg-gray-200","rounded-lg","w-40"],[1,"text-center","py-16"],[1,"mx-auto","w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-5 5-5-5h5zm-5-2V5a2 2 0 012-2h4a2 2 0 012 2v10"],[1,"text-gray-500","text-lg","font-medium"],[1,"p-6","pb-4"],[1,"flex","justify-between","items-start"],[1,"flex","items-start","gap-3","flex-1","min-w-0"],[1,"flex-shrink-0","mt-1"],[1,"w-3","h-3","rounded-full","bg-gradient-to-r","from-blue-500","to-blue-600","shadow-sm","relative"],[1,"absolute","inset-0","rounded-full","bg-blue-500","animate-ping","opacity-20"],[1,"min-w-0","flex-1"],[1,"text-gray-900","font-semibold","text-lg","leading-tight","mb-1","group-hover:text-blue-700","transition-colors","duration-200"],[1,"flex-shrink-0","ml-4"],[1,"w-20","h-12","rounded-lg","bg-gray-50","border","border-gray-100"],["src","/logo.png","alt","",1,"w-full"],[1,"min-w-0"],[1,"text-gray-400","text-lg","leading-tight","mb-1","group-hover:text-blue-700","transition-colors","duration-200"],[1,"min-w-0","px-9"],[1,"text-gray-900","text-lg","leading-tight","mb-1","group-hover:text-blue-700","transition-colors","duration-200"],[1,"px-6","pb-4"],[1,"inline-flex","items-center","gap-2","bg-gray-50","px-3","py-2","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-sm","font-semibold","text-gray-900"],[1,"px-6","pb-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d",`M9 12h6m-6 4h6M7 4h10a2 2 0 012 2v12a2 2 0 
           01-2 2H7a2 2 0 01-2-2V6a2 2 0 
           012-2z`],[3,"ngSwitch"],["class","w-5 h-5 text-green-500","fill","currentColor","viewBox","0 0 20 20",4,"ngSwitchCase"],["class","w-5 h-5 text-yellow-500","fill","currentColor","viewBox","0 0 20 20",4,"ngSwitchCase"],["class","w-5 h-5 text-red-400","fill","currentColor","viewBox","0 0 20 20",4,"ngSwitchCase"],["class","w-5 h-5 text-gray-300","fill","currentColor","viewBox","0 0 20 20",4,"ngSwitchDefault"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-green-500"],["fill-rule","evenodd","d",`M16.707 5.293a1 1 0 00-1.414 0L8 12.586 
             4.707 9.293a1 1 0 00-1.414 1.414l4 
             4a1 1 0 001.414 0l8-8a1 1 0 
             000-1.414z`,"clip-rule","evenodd"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-yellow-500"],["fill-rule","evenodd","d",`M10 18a8 8 0 100-16 8 8 0 
             000 16zm1-11a1 1 0 10-2 
             0v4a1 1 0 00.293.707l2.828 
             2.829a1 1 0 101.415-1.415L11 
             10.586V7z`,"clip-rule","evenodd"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-gray-300"],["cx","10","cy","10","r","8"],[1,"inline-flex","items-center","gap-2","bg-gradient-to-r","from-blue-600","to-blue-700","hover:from-blue-700","hover:to-blue-800","text-white","font-semibold","py-3","px-6","rounded-xl","shadow-sm","hover:shadow-md","transition-all","duration-200","transform","hover:-translate-y-0.5","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"]],template:function(i,t){i&1&&(a(0,"div",0)(1,"button",1),b("click",function(){return t.activeTab.set("general")}),s(2),o(),a(3,"button",1),b("click",function(){return t.activeTab.set("policies")}),s(4),o(),a(5,"button",1),b("click",function(){return t.activeTab.set("claims")}),s(6),o()(),y(7,_t,2,2,"div",2)(8,ft,7,3,"div",3),a(9,"div",4),F(10,Ct,30,9,"div",5,gt),o()),i&2&&(r(),x(t.activeTab()==="general"?"flex-1 py-3 px-4 rounded-lg bg-white text-blue-600 font-semibold shadow-sm transition-all duration-300 ease-in-out transform":"flex-1 py-3 px-4 rounded-lg text-gray-600 font-medium hover:text-gray-800 hover:bg-white/50 transition-all duration-200"),r(),d(" ",t.lang()=="ar"?"\u0627\u0634\u0639\u0627\u0631\u0627\u062A \u0639\u0627\u0645\u0647":"General"," "),r(),x(t.activeTab()==="policies"?"flex-1 py-3 px-4 rounded-lg bg-white text-blue-600 font-semibold shadow-sm transition-all duration-300 ease-in-out transform":"flex-1 py-3 px-4 rounded-lg text-gray-600 font-medium hover:text-gray-800 hover:bg-white/50 transition-all duration-200"),r(),d(" ",t.lang()=="ar"?"\u0627\u0634\u0639\u0627\u0631\u0627\u062A \u0627\u0644\u0648\u062B\u0627\u0626\u0642":"Policies"," "),r(),x(t.activeTab()==="claims"?"flex-1 py-3 px-4 rounded-lg bg-white text-blue-600 font-semibold shadow-sm transition-all duration-300 ease-in-out transform":"flex-1 py-3 px-4 rounded-lg text-gray-600 font-medium hover:text-gray-800 hover:bg-white/50 transition-all duration-200"),r(),d(" ",t.lang()=="ar"?"\u0627\u0634\u0639\u0627\u0631\u0627\u062A \u0627\u0644\u0645\u0637\u0627\u0644\u0628\u0627\u062A":"Claims"," "),r(),_("ngIf",t.isLoading()),r(),_("ngIf",!t.isLoading()&&t.currentTabNotification().length===0),r(2),$(t.currentTabNotification()))},dependencies:[W,H,Y,J,K,Q,et,ot,at],encapsulation:2,data:{animation:[it("fadeInOut",[E("loading",T({opacity:.7})),E("loaded",T({opacity:1})),P("loading => loaded",[I("0.5s ease-in")]),P("loaded => loading",[I("0.3s ease-out")])])]}})};export{dt as NotificationsComponent};
