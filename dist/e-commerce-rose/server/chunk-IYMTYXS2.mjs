import './polyfills.server.mjs';
import{A as p,Dc as m,F as c,I as b,M as h,ad as u,b as l,ea as i,l as g}from"./chunk-UQC3G75Y.mjs";var d=class n{_http=h(m);baseUrl=u.BASE_URL;CACHE_EXPIRATION=5*60*1e3;blogsCache=i(new Map);singleBlogCache=i(new Map);cacheTimestamps=i(new Map);isBrowser(){return typeof window<"u"}getArabicBlogs(t=1){if(!this.isBrowser())return new l(a=>a.complete());let e=`blogs-page-${t}`,s=this.blogsCache().get(t);return this.isCacheValid(e)&&s?g(s):this._http.get(`${this.baseUrl}app-blogs/getArabicBlogs?page=${t}`).pipe(c(a=>{this.blogsCache.update(o=>new Map(o).set(t,a)),this.updateCacheTimestamp(e)}),p(1))}getSingleArabicBlog(t){if(!this.isBrowser())return new l(a=>a.complete());let e=`blog-${t}`,s=this.singleBlogCache().get(e);return this.isCacheValid(e)&&s?g(s):this._http.get(`${this.baseUrl}app-blogs/getSingleArabicBlogs/${t}`).pipe(c(a=>{this.singleBlogCache.update(o=>new Map(o).set(e,a)),this.updateCacheTimestamp(e)}),p(1))}invalidateCache(t){if(t.startsWith("blogs-page-")){let e=t.match(/blogs-page-(\d+)/);if(e){let s=parseInt(e[1],10);this.blogsCache.update(r=>{let a=new Map(r);return a.delete(s),a})}}else t.startsWith("blog-")&&this.singleBlogCache.update(e=>{let s=new Map(e);return s.delete(t),s});this.cacheTimestamps.update(e=>{let s=new Map(e);return s.delete(t),s})}clearBlogsCache(){this.blogsCache.set(new Map),this.cacheTimestamps.update(t=>{let e=new Map;for(let[s,r]of t.entries())s.startsWith("blogs-page-")||e.set(s,r);return e})}isCacheValid(t){let e=this.cacheTimestamps().get(t)||0;return e!==0&&Date.now()-e<this.CACHE_EXPIRATION}updateCacheTimestamp(t,e=Date.now()){this.cacheTimestamps.update(s=>new Map(s).set(t,e))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};export{d as a};
