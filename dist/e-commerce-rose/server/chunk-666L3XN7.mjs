import './polyfills.server.mjs';
import{I as a,M as o,Rc as n,ia as s,qc as i}from"./chunk-UQC3G75Y.mjs";var l=class r{TOKEN_KEY="auth_token";USER_DATA_KEY="user_data";router=o(n);platformId=o(s);get isBrowser(){return i(this.platformId)}saveToken(e,t){if(!this.isBrowser)return;let u=new Date().getTime()+t*1e3,m={token:e,expiresAt:u};localStorage.setItem(this.TOKEN_KEY,JSON.stringify(m))}saveUserData(e){this.isBrowser&&localStorage.setItem(this.USER_DATA_KEY,JSON.stringify(e))}getUserData(){if(!this.isBrowser)return null;let e=localStorage.getItem(this.USER_DATA_KEY);if(!e)return null;try{return JSON.parse(e)}catch{return this.removeUserData(),null}}removeUserData(){this.isBrowser&&(localStorage.removeItem(this.USER_DATA_KEY),localStorage.removeItem("isPassword"))}getToken(){if(!this.isBrowser)return null;let e=localStorage.getItem(this.TOKEN_KEY);if(!e)return null;try{let t=JSON.parse(e);return new Date().getTime()>t.expiresAt?(this.removeToken(),null):t.token}catch{return this.removeToken(),null}}removeToken(){this.isBrowser&&localStorage.removeItem(this.TOKEN_KEY)}isAuthenticated(){return this.isBrowser?this.getToken()!==null:!1}logout(){this.removeToken(),this.removeUserData(),this.isBrowser&&this.router.navigate(["/"])}static \u0275fac=function(t){return new(t||r)};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
