import './polyfills.server.mjs';
import{b as Z}from"./chunk-FXIUZE2V.mjs";import{e as te}from"./chunk-D4LSP6XO.mjs";import"./chunk-7XZGEYGO.mjs";import{b as q,c as x,d as O,e as V,i as Y,l as K,m as z,u as U,w as H}from"./chunk-YRG62QXE.mjs";import"./chunk-666L3XN7.mjs";import{c as w,d,f as o,g as F,i as v,j,k as R,o as ee}from"./chunk-VP43NVKH.mjs";import{$c as W,Aa as T,Ab as p,E as C,Fa as h,La as k,M as m,Ma as u,Oa as E,Rc as X,Sa as _,Xa as n,Ya as r,Za as I,Zc as J,_c as Q,bb as y,c as A,cb as B,cc as D,db as M,ea as g,ia as L,kb as c,lb as P,mb as b,oc as $,qc as G,ub as N,va as a,zb as l}from"./chunk-UQC3G75Y.mjs";import"./chunk-X2SEQXRR.mjs";var ae=e=>({"sm:text-left":e});function se(e,i){e&1&&(n(0,"span",11),c(1),l(2,"translate"),r()),e&2&&(a(),P(p(2,1,"pages.auth.login.login-form.errors.password-required")))}function ne(e,i){e&1&&(n(0,"span",11),c(1),l(2,"translate"),r()),e&2&&(a(),P(p(2,1,"pages.auth.login.login-form.errors.password-minlength")))}function oe(e,i){if(e&1&&h(0,se,3,3,"span",11)(1,ne,3,3,"span",11),e&2){let s,t=B();_((s=t.setPassForm.get("password"))!=null&&s.hasError("required")?0:(s=t.setPassForm.get("password"))!=null&&s.hasError("minlength")?1:-1)}}function re(e,i){e&1&&(n(0,"span",11),c(1),l(2,"translate"),r()),e&2&&(a(),P(p(2,1,"Passwords_not_match")))}function le(e,i){e&1&&(n(0,"span"),c(1,"Loading..."),r())}function pe(e,i){e&1&&(c(0),l(1,"translate")),e&2&&b(" ",p(1,1,"pages.auth.login.login-form.button")," ")}var ie=class e{destroy$=new A;_fb=m(U);_authService=m(te);_router=m(X);_languageService=m(ee);_alertService=m(Z);_translate=m(J);_PLATFORM_ID=m(L);currentLang$=this._languageService.currentLanguage$;setPassForm;isLoading=g(!1);isChecked=g(!1);shakeState=g("idle");formSubmitted=g(!1);ngOnInit(){this.initForm()}initForm(){this.setPassForm=this._fb.group({password:["",[x.required,x.minLength(8)]],rePassword:["",[x.required,x.minLength(8)]]},{validators:this.passwordMatchValidator})}loggedInSuccessfully(i){this.isLoading.set(!1);let s="";this.currentLang$.pipe(C(this.destroy$)).subscribe(t=>s=t),i.success?(this._alertService.showNotification({translationKeys:{title:"Login_successful"}}),this.setPassForm.reset(),G(this._PLATFORM_ID)&&localStorage.setItem("isPassword","true"),this._router.navigate(["/",s,"home"])):this.triggerShakeAnimation()}loginSuccessfully(i){this.isLoading.set(!1),this._alertService.showNotification({translationKeys:{title:this._translate.instant("Login_failed")}}),this.triggerShakeAnimation()}passwordMatchValidator(i){let s=i.get("password")?.value,t=i.get("rePassword")?.value;return s===t?null:{passwordMismatch:!0}}submission(){if(this.formSubmitted.set(!0),this.setPassForm.invalid){this.setPassForm.markAllAsTouched(),this.triggerShakeAnimation();return}this.isLoading.set(!0),this._authService.setPassword(this.setPassForm.value).pipe(C(this.destroy$)).subscribe({next:i=>{this.loggedInSuccessfully(i)},error:i=>{this.loginSuccessfully(i)},complete:()=>{setTimeout(()=>{this._alertService.hide()},2e3)}})}onPasswordFocus(){this.setPassForm.get("password")?.markAsTouched()}triggerShakeAnimation(){this.shakeState.set("shake"),setTimeout(()=>{this.shakeState.set("idle")},500)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(s){return new(s||e)};static \u0275cmp=T({type:e,selectors:[["app-set-password"]],decls:30,vars:32,consts:[[1,"flex","flex-col","md:flex-row","gap-6","md:gap-12","py-12","w-full","max-w-7xl","mx-auto"],[1,"flex","px-4","flex-1","flex-col","gap-4","w-full","md:w-1/2","lg:w-1/3"],[1,"flex","flex-col","gap-2",3,"ngClass"],[1,"text-[#000]","font-Alexandria","text-[16px]","sm:text-[18px]","md:text-[20px]","font-normal","leading-[24px]","sm:leading-[30px]"],[1,"text-[#F00]","font-Alexandria","text-xs","md:text-base","font-medium","leading-[24px]","sm:leading-[30px]"],["novalidate","",3,"ngSubmit","formGroup"],[1,"flex","flex-col","mb-2"],[1,""],["formControlName","password","type","password","id","password",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-container"],["formControlName","rePassword","type","password","id","rePassword",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-message"],[1,"flex","justify-between","items-center"],["type","submit",1,"general-btn","bg-blue-600","text-white","py-2","px-16","rounded-lg","hover:bg-blue-700","transition-colors",3,"disabled"],[1,"flex","flex-1","justify-center","items-start","w-full","md:w-1/2","lg:w-2/3"],["loading","lazy","src","assets/profile/profile.jpg",1,"w-full","hidden","md:block","max-h-[577px]","object-cover","rounded-[30px]",3,"alt"]],template:function(s,t){if(s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),c(4),l(5,"translate"),r(),n(6,"p",4),c(7),l(8,"translate"),r()(),n(9,"form",5),y("ngSubmit",function(){return t.submission()}),n(10,"div",6)(11,"div",7)(12,"input",8),l(13,"translate"),y("focus",function(){return t.onPasswordFocus()}),r()(),n(14,"div",9),h(15,oe,2,1),r()(),n(16,"div",6)(17,"div",7)(18,"input",10),l(19,"translate"),y("focus",function(){return t.onPasswordFocus()}),r()(),n(20,"div",9),h(21,re,3,3,"span",11),r()(),n(22,"div",12)(23,"button",13),l(24,"translate"),h(25,le,2,0,"span")(26,pe,2,3),r()()()(),n(27,"div",14),I(28,"img",15),l(29,"translate"),r()()),s&2){let f,S;u("@formAnimation",void 0),a(2),u("ngClass",N(30,ae,t._translate.currentLang==="en")),a(2),b(" ",p(5,18,"pages.auth.set_password.headline")," "),a(3),b(" ",p(8,20,"pages.auth.set_password.hub_head")," "),a(2),u("formGroup",t.setPassForm)("@inputAnimation",void 0)("@shake",t.shakeState()),a(3),u("placeholder",p(13,22,"pages.auth.set_password.set_password_form.new-password-placeholder")),a(3),_((f=t.setPassForm.get("password"))!=null&&f.touched&&((f=t.setPassForm.get("password"))!=null&&f.invalid)?15:-1),a(3),u("placeholder",p(19,24,"pages.auth.set_password.set_password_form.confirm_new_password-placeholder")),a(3),_((S=t.setPassForm.get("rePassword"))!=null&&S.touched&&((S=t.setPassForm.get("rePassword"))!=null&&S.invalid)&&t.setPassForm.hasError("passwordMismatch")?21:-1),a(2),E("opacity-50",t.isLoading()),u("disabled",t.isLoading()),k("aria-label",p(24,26,"pages.auth.login.login-form.submit-button-aria-label")),a(2),_(t.isLoading()?25:26),a(3),M("alt",p(29,28,"pages.auth.login.login-image_alt")),u("@imageAnimation",void 0)}},dependencies:[$,D,W,Q,H,Y,q,O,V,K,z],encapsulation:2,data:{animation:[w("formAnimation",[v(":enter",[o({opacity:0,transform:"translateY(20px)"}),d("500ms ease-out",o({opacity:1,transform:"translateY(0)"}))])]),w("inputAnimation",[v(":enter",[j("input, label, div, .error-container",[o({opacity:0,transform:"translateY(10px)"}),R(80,[d("400ms ease-out",o({opacity:1,transform:"translateY(0)"}))])],{optional:!0})])]),w("imageAnimation",[v(":enter",[o({opacity:0,transform:"scale(0.8)"}),d("700ms ease-out",o({opacity:1,transform:"scale(1)"}))])]),w("shake",[F("idle",o({transform:"translateX(0)"})),F("shake",o({transform:"translateX(0)"})),v("idle => shake",[d("50ms",o({transform:"translateX(-10px)"})),d("100ms",o({transform:"translateX(10px)"})),d("100ms",o({transform:"translateX(-10px)"})),d("100ms",o({transform:"translateX(10px)"})),d("50ms",o({transform:"translateX(0)"}))])])]}})};export{ie as SetPasswordComponent};
