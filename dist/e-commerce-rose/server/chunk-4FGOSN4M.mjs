import './polyfills.server.mjs';
import{b as Y}from"./chunk-FXIUZE2V.mjs";import{e as K}from"./chunk-D4LSP6XO.mjs";import"./chunk-7XZGEYGO.mjs";import{b as q,c,d as M,e as G,i as X,l as $,m as z,u as V,w as j}from"./chunk-YRG62QXE.mjs";import"./chunk-666L3XN7.mjs";import{c as b,d as m,f as s,g as P,i as x,j as I,k as N,o as O}from"./chunk-VP43NVKH.mjs";import{$c as Z,Aa as R,Ab as p,Fa as _,La as A,M as w,Ma as d,Oa as T,Rc as B,Sa as v,Xa as o,Ya as n,Za as S,_c as D,bb as y,cb as F,db as E,ea as C,kb as u,lb as g,mb as k,oc as L,va as a,zb as l}from"./chunk-UQC3G75Y.mjs";import"./chunk-X2SEQXRR.mjs";function J(e,r){e&1&&(o(0,"span",8),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"pages.auth.reset-password.errors.password-required")))}function Q(e,r){e&1&&(o(0,"span",8),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"pages.auth.reset-password.errors.password-minlength")))}function U(e,r){e&1&&(o(0,"span",8),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"pages.auth.reset-password.errors.password-pattern")))}function W(e,r){if(e&1&&_(0,J,3,3,"span",8)(1,Q,3,3,"span",8)(2,U,3,3,"span",8),e&2){let i,t=F();v((i=t.resetForm.get("password"))!=null&&i.hasError("required")?0:(i=t.resetForm.get("password"))!=null&&i.hasError("minlength")?1:(i=t.resetForm.get("password"))!=null&&i.hasError("pattern")?2:-1)}}function ee(e,r){e&1&&(o(0,"span",8),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"pages.auth.reset-password.errors.confirm-password-required")))}function te(e,r){if(e&1&&_(0,ee,3,3,"span",8),e&2){let i,t=F();v((i=t.resetForm.get("password_confirmation"))!=null&&i.hasError("required")?0:-1)}}function ie(e,r){e&1&&(o(0,"span",8),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"pages.auth.reset-password.errors.confirm-password-mismatch")))}function re(e,r){e&1&&(o(0,"span"),u(1),l(2,"translate"),n()),e&2&&(a(),g(p(2,1,"Loading")))}function ae(e,r){e&1&&(u(0),l(1,"translate")),e&2&&k(" ",p(1,1,"pages.auth.reset-password.button")," ")}var H=class e{_fb=w(V);_authService=w(K);_router=w(B);_languageService=w(O);_alertService=w(Y);currentLang$=this._languageService.currentLanguage$;resetForm;isLoading=C(!1);shakeState=C("idle");formSubmitted=C(!1);email="";ngOnInit(){this.email=this._authService.getResetEmail()||"",this.initForm()}initForm(){this.resetForm=this._fb.group({email:[{value:this.email,disabled:!0},[c.required,c.email,c.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],password:["",[c.required,c.minLength(8),c.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/)]],password_confirmation:["",[c.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(r){return r.get("password")?.value===r.get("password_confirmation")?.value?null:{mismatch:!0}}submition(){if(this.formSubmitted.set(!0),this.resetForm.invalid){this.resetForm.markAllAsTouched(),this.triggerShakeAnimation();return}this.isLoading.set(!0),this._authService.resetPassword(this.resetForm.getRawValue()).subscribe({next:r=>{this.isLoading.set(!1);let i="";this.currentLang$.subscribe(t=>i=t),this._alertService.showNotification({imagePath:"./common/settings.webp",translationKeys:{title:"Reset_password_successful"}}),this._authService.clearResetEmail(),this.resetForm.reset(),this._router.navigate(["/",i,"login"])},error:r=>{this.isLoading.set(!1);let i=r?.error?.message||"Reset password failed. Please try again.";this._alertService.showNotification({imagePath:"./common/before-remove.webp",translationKeys:{title:i}}),this.triggerShakeAnimation()},complete:()=>{setTimeout(()=>{this._alertService.hide()},2e3)}})}onPasswordFocus(){this.resetForm.get("password")?.markAsTouched()}onConfirmPasswordFocus(){this.resetForm.get("password_confirmation")?.markAsTouched()}triggerShakeAnimation(){this.shakeState.set("shake"),setTimeout(()=>{this.shakeState.set("idle")},500)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=R({type:e,selectors:[["app-reset-password"]],decls:28,vars:26,consts:[[1,"flex","md:p-4","flex-col","md:flex-row","gap-6","md:gap-12","py-12","w-full","max-w-7xl","mx-auto"],[1,"flex","px-4","flex-1","flex-col","gap-4","w-full","md:w-1/2","lg:w-1/3"],["novalidate","",3,"ngSubmit","formGroup"],[1,"flex","flex-col","mb-2"],["formControlName","email","type","email","id","email","readonly","",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500","bg-gray-100",3,"placeholder"],["formControlName","password","type","password","id","password",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-container"],["formControlName","password_confirmation","type","password","id","password_confirmation",1,"general-input","w-full","border","border-gray-300","rounded-lg","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"focus","placeholder"],[1,"error-message"],[1,"flex","justify-between","items-center"],["type","submit",1,"general-btn","bg-blue-600","text-white","py-2","px-16","rounded-lg","hover:bg-blue-700","transition-colors",3,"disabled"],[1,"hiden","md:flex","flex-1","justify-center","items-start","w-full","md:w-1/2","lg:w-2/3"],["loading","eager","fetchpriority","high","src","assets/profile/profile.jpg",1,"w-full","max-h-[577px]","object-cover","rounded-[30px]",3,"alt"]],template:function(i,t){if(i&1&&(o(0,"div",0)(1,"div",1)(2,"form",2),y("ngSubmit",function(){return t.submition()}),o(3,"div",3)(4,"div"),S(5,"input",4),l(6,"translate"),n()(),o(7,"div",3)(8,"div")(9,"input",5),l(10,"translate"),y("focus",function(){return t.onPasswordFocus()}),n()(),o(11,"div",6),_(12,W,3,1),n()(),o(13,"div",3)(14,"div")(15,"input",7),l(16,"translate"),y("focus",function(){return t.onConfirmPasswordFocus()}),n()(),o(17,"div",6),_(18,te,1,1)(19,ie,3,3,"span",8),n()(),o(20,"div",9)(21,"button",10),l(22,"translate"),_(23,re,3,3,"span")(24,ae,2,3),n()()()(),o(25,"div",11),S(26,"img",12),l(27,"translate"),n()()),i&2){let f,h;d("@formAnimation",void 0),a(2),d("formGroup",t.resetForm)("@inputAnimation",void 0)("@shake",t.shakeState()),a(3),d("placeholder",p(6,16,"pages.auth.reset-password.email-placeholder")),a(4),d("placeholder",p(10,18,"pages.auth.reset-password.password-placeholder")),a(3),v((f=t.resetForm.get("password"))!=null&&f.touched&&((f=t.resetForm.get("password"))!=null&&f.invalid)?12:-1),a(3),d("placeholder",p(16,20,"pages.auth.reset-password.confirm-password-placeholder")),a(3),v((h=t.resetForm.get("password_confirmation"))!=null&&h.touched&&((h=t.resetForm.get("password_confirmation"))!=null&&h.invalid)?18:t.resetForm.errors!=null&&t.resetForm.errors.mismatch&&((h=t.resetForm.get("password_confirmation"))!=null&&h.touched)?19:-1),a(3),T("opacity-50",t.isLoading()),d("disabled",t.isLoading()),A("aria-label",p(22,22,"pages.auth.reset-password.submit-button-aria-label")),a(2),v(t.isLoading()?23:24),a(3),E("alt",p(27,24,"pages.auth.reset-password.image_alt")),d("@imageAnimation",void 0)}},dependencies:[L,Z,D,j,X,q,M,G,$,z],encapsulation:2,data:{animation:[b("formAnimation",[x(":enter",[s({opacity:0,transform:"translateY(20px)"}),m("500ms ease-out",s({opacity:1,transform:"translateY(0)"}))])]),b("inputAnimation",[x(":enter",[I("input, label, div, .error-container",[s({opacity:0,transform:"translateY(10px)"}),N(80,[m("400ms ease-out",s({opacity:1,transform:"translateY(0)"}))])],{optional:!0})])]),b("imageAnimation",[x(":enter",[s({opacity:0,transform:"scale(0.8)"}),m("700ms ease-out",s({opacity:1,transform:"scale(1)"}))])]),b("shake",[P("idle",s({transform:"translateX(0)"})),P("shake",s({transform:"translateX(0)"})),x("idle => shake",[m("50ms",s({transform:"translateX(-10px)"})),m("100ms",s({transform:"translateX(10px)"})),m("100ms",s({transform:"translateX(-10px)"})),m("100ms",s({transform:"translateX(10px)"})),m("50ms",s({transform:"translateX(0)"}))])])]}})};export{H as ResetPasswordComponent};
