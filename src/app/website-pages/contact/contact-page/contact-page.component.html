<!-- Section خارج container عشان ياخد العرض الكامل -->

<!-- العنوان فوق الماب والكروت -->
<div class="w-full px-8 mt-12">
  <div class="container">
    <div class="w-full text-start">
      <div class="get-in-touch flex items-center gap-2">
        <div class="text-xl test-mar font-bold">__</div>
        {{ 'GET_IN_TOUCH' | translate }}
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div class="map">
    <!-- Skeleton Loader for Map -->
    @if (isMapLoading()) {
      <div class="w-full h-full bg-gray-400 animate-pulse"></div>
    }
    <iframe 
      loading="eager" 
      fetchpriority="high" 
      src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3454.042295475344!2d31.203296924724594!3d30.035644418988173!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x145846cec4095555%3A0x1750bf5bdcd697d3!2zMjAg2KfZhNiq2K3YsdmK2LHYjCDYp9mE2K_ZgtmK2Iwg2YXZhdmA2YXYqNi52KfZhNmC2YrYjCDZhdit2KfZgdi42Kkg2KfZhNis2YrYstipIDM3NTAxNjE!5e0!3m2!1sar!2seg!4v1753191885380!5m2!1sar!2seg" 
      width="600" 
      height="450" 
      style="border:0;" 
      [class.opacity-0]="isMapLoading()"
      [class.opacity-100]="!isMapLoading()"
      style="border:0; transition: opacity 0.3s ease-in-out;"
      allowfullscreen="" 
      loading="lazy" 
      referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>
  <div class="cards">
    <!-- Skeleton Loader for Cards -->
    @if (isLoading()) {
      <div class="flex flex-col md:flex-row gap-4" @skeletonAnimation>
        @for (i of [1,2,3]; track i) {
          <div class="card">
            <div class="card-icon-wrapper">
              <div class="card-icon h-10 w-10 bg-gray-200 rounded-full animate-pulse"></div>
            </div>
            <div class="card-title h-6 w-1/2 bg-gray-200 rounded animate-pulse"></div>
            <div class="card-title--subtext h-4 w-3/4 bg-gray-200 rounded animate-pulse"></div>
          </div>
        }
      </div>
    }
    <!-- Contact Cards -->
    @if (!isLoading()) {
      <div class="flex flex-col md:flex-row gap-4" @cardsAnimation>
        <div class="card">
          <div class="card-icon-wrapper">
            <div class="card-icon">
              <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M22.3903 3.44922H3.60968C1.61621 3.44922 0 5.06543 0 7.0589V18.9409C0 20.9344 1.61621 22.5506 3.60968 22.5506H22.3903C24.3837 22.5506 26 20.9344 26 18.9409V7.0589C26 5.06543 24.3837 3.44922 22.3903 3.44922ZM9.04749 16.3372L3.99273 20.6496C3.63619 20.9539 3.1002 20.9116 2.79596 20.5547C2.49168 20.1981 2.53398 19.6621 2.89093 19.3579L7.94569 15.0456C8.30218 14.7413 8.83812 14.7836 9.1424 15.1405C9.44668 15.497 9.40438 16.033 9.04749 16.3372ZM13 14.6978C12.3239 14.6961 11.6685 14.471511.1561 14.0284L11.1565 14.0288L11.1549 14.0276C11.1553 14.028 11.1558 14.028 11.1561 14.0284L3.40041 7.29686C3.04596 6.98923 3.00823 6.45329 3.31541 6.09929C3.62299 5.74484 4.15898 5.70711 4.51293 6.01428L12.2708 12.7475C12.4366 12.895 12.7098 13.0016 13 12.9999C13.2898 13.0008 13.5583 12.8971 13.7333 12.7446L13.737 12.7413L21.487 6.01433C21.841 5.70716 22.377 5.74489 22.6846 6.09934C22.9917 6.45329 22.954 6.98928 22.5996 7.29691L14.8417 14.0305C14.331 14.469 13.6765 14.697 13 14.6978ZM23.2044 20.5547C22.9001 20.9116 22.3641 20.9539 22.0077 20.6496L16.9529 16.3372C16.596 16.033 16.5537 15.497 16.858 15.1405C17.1622 14.7836 17.6982 14.7413 18.0547 15.0456L23.1095 19.3579C23.4664 19.6621 23.5087 20.1981 23.2044 20.5547Z"
                  fill="white" />
              </svg>
            </div>
          </div>
          <div class="card-title">{{ 'pages.contact.EMAIL'   | translate }}</div>
          <a class="card-title--subtext" [href]="'mailto:'+contactData?.contact?.email" *ngIf="contactData?.contact">{{ contactData?.contact?.email }}</a>
        </div>
        <div class="card">
          <div class="card-icon-wrapper">
            <div class="card-icon">
              <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M8.42961 17.5323C11.5745 20.6772 15.4048 23.1038 18.5278 23.1038C19.9316 23.1038 21.1612 22.6141 22.1514 21.5259C22.728 20.8839 23.0873 20.1331 23.0873 19.3931C23.0873 18.8491 22.8805 18.3267 22.3582 17.9568L19.0284 15.5845C18.517 15.2363 18.0926 15.0622 17.7008 15.0622C17.2002 15.0622 16.765 15.3451 16.2644 15.8348L15.4918 16.5965C15.3721 16.7162 15.2198 16.7706 15.0783 16.7706C14.9042 16.7706 14.7519 16.7054 14.6322 16.6509C13.9684 16.2918 12.8149 15.3016 11.7376 14.2352C10.6712 13.1688 9.681 12.0153 9.33279 11.3407C9.26751 11.221 9.21309 11.0686 9.21309 10.9054C9.21309 10.7639 9.25664 10.6225 9.37634 10.5028L10.138 9.70844C10.6277 9.20784 10.9106 8.77258 10.9106 8.27203C10.9106 7.88031 10.7366 7.45591 10.3774 6.9445L8.03785 3.64733C7.65699 3.12501 7.12381 2.89648 6.53621 2.89648C5.81801 2.89648 5.06716 3.22292 4.43601 3.84321C3.3805 4.85521 2.9126 6.1066 2.9126 7.48855C2.9126 10.6116 5.29568 14.3984 8.42961 17.5323Z"
                  fill="white" />
              </svg>
            </div>
          </div>
          <div class="card-title">{{ 'pages.contact.PHONE' | translate }}</div>
          <a class="card-title--subtext" [href]="'tel:'+(contactData?.contact?.first_phone! | phoneFormat)" *ngIf="contactData?.contact">{{ contactData?.contact?.first_phone }}</a>
          <a class="card-title--subtext" [href]="'tel:'+(contactData?.contact?.second_phone! | phoneFormat)"  *ngIf="contactData?.contact">{{ contactData?.contact?.second_phone }}</a>
          <a class="card-title--subtext" [href]="'tel:'+(contactData?.contact?.third_phone! | phoneFormat)"  *ngIf="contactData?.contact">{{ contactData?.contact?.third_phone }}</a>
          <a class="card-title--subtext" [href]="'tel:'+(contactData?.contact?.fourth_phone! | phoneFormat)"  *ngIf="contactData?.contact">{{ contactData?.contact?.fourth_phone }}</a>
        </div>
        <div class="card">
          <div class="card-icon-wrapper">
            <div class="card-icon">
              <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1566_17326)">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M13 7.3125C11.6537 7.3125 10.5625 8.40369 10.5625 9.75C10.5625 11.0963 11.6537 12.1875 13 12.1875C14.3463 12.1875 15.4375 11.0963 15.4375 9.75C15.4375 8.40369 14.3463 7.3125 13 7.3125ZM13 13.8125C10.7567 13.8125 8.9375 11.9941 8.9375 9.75C8.9375 7.50588 10.7567 5.6875 13 5.6875C15.2433 5.6875 17.0625 7.50588 17.0625 9.75C17.0625 11.9941 15.2433 13.8125 13 13.8125ZM13 0C7.61556 0 3.25 4.36556 3.25 9.75C3.25 13.8271 11.3791 26.0089 13 26C14.5957 26.0089 22.75 13.7719 22.75 9.75C22.75 4.36556 18.3844 0 13 0Z" fill="white"/>
                </g>
                <defs>
                  <clipPath id="clip0_1566_17326">
                    <rect width="26" height="26" fill="white"/>
                  </clipPath>
                </defs>
              </svg>
            </div>
          </div>
          <div class="card-title">{{ 'pages.contact.OUR_LOCATION' | translate }}</div>
          <a target="_blank" rel="noopener" [href]="'https://www.google.com/maps/search/?api=1&query='+encodeAddress(contactData?.contact?.en_address!)" class="card-title--subtext" *ngIf="contactData?.contact">{{ this.translate.currentLang === 'en' ? contactData?.contact?.en_address : contactData?.contact?.ar_address }}</a>
        </div>
      </div>
    }
  </div>
</div>

<!-- <div class="flex gap-8 justify-center items-center w-full">
  <div>
    <img src="assets/contact/phone.png" alt="Phone icon" onerror="this.onerror=null;this.src='https://placehold.co/60x60/cccccc/333333?text=Phone';" />
  </div>
</div> -->

<div class="flex flex-wrap relative z-1 overflow-hidden gap-10 justify-center items-center w-full my-12 flex-col md:flex-row">
  <img class="absolute -z-1 top-0 -right-15 hidden md:block" src="assets/contact/form-bg.png" alt="Form background graphic"
    onerror="this.onerror=null;this.src='https://placehold.co/300x300/cccccc/333333?text=BG';" />

  <div class="contact-form-img overflow-hidden relative mx-2">
    <!-- Image Loading Skeleton -->
    @if (isImageLoading()) {
      <div class="w-full h-full bg-gray-200 animate-pulse absolute inset-0 z-10"></div>
    }
    <img 
      class="w-full h-full object-cover" 
      src="assets/contact/contact-img.png" 
      alt="Contact illustration"
      (load)="onImageLoad()"
      [class.opacity-0]="isImageLoading()"
      [class.opacity-100]="!isImageLoading()"
      style="transition: opacity 0.3s ease-in-out;"
      onerror="this.onerror=null;this.src='https://placehold.co/400x400/cccccc/333333?text=Contact';onImageLoad();" />
  </div>

  <div class="flex flex-col gap-[25px] w-full max-w-[660px]">
    <!-- Skeleton Loader for Form -->
    @if (isLoading()) {
      <div class="flex flex-col gap-4" @skeletonAnimation>
        <div class="h-8 w-3/4 bg-gray-200 rounded animate-pulse"></div>
        <div class="h-4 w-full bg-gray-200 rounded animate-pulse"></div>
        <div class="h-12 w-full bg-gray-200 rounded-lg animate-pulse"></div>
        <div class="h-12 w-full bg-gray-200 rounded-lg animate-pulse"></div>
        <div class="h-12 w-full bg-gray-200 rounded-lg animate-pulse"></div>
        <div class="h-32 w-full bg-gray-200 rounded-lg animate-pulse"></div>
        <div class="h-12 w-1/3 bg-gray-200 rounded-lg animate-pulse"></div>
      </div>
    }
    <!-- Form -->
    @if (!isLoading()) {
      <div @formAnimation class="mx-4">
        <h2 class="contact-form-heading mt-4 ">{{ 'pages.contact.LETS_STAY_IN_TOUCH' | translate }}</h2>
        <p class="contact-form-text">
          {{ 'pages.contact.CONTACT_FORM_DESCRIPTION' | translate }}
        </p>

        <form [formGroup]="contactForm" (ngSubmit)="onSubmit()" novalidate>
          <div class="flex flex-col">
            <input 
              formControlName="name" 
              type="text" 
              id="name"
              autocomplete="name"
              (keydown)="preventNumbers($event)" 
              (input)="restrictToLetters($event)"
              class="general-input w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="{{ 'pages.contact.FULL_NAME_PLACEHOLDER' | translate }}" />
            <div class="error-container">
              @if (contactForm.get('name')?.touched && contactForm.get('name')?.invalid) {
                @if (contactForm.get('name')?.hasError('required')) {
                  <span class="error-message">{{ 'pages.contact.FULL_NAME_REQUIRED_ERROR' | translate }}</span>
                } @else if (contactForm.get('name')?.hasError('minlength')) {
                  <span class="error-message">{{ 'pages.contact.FULL_NAME_MINLENGTH_ERROR' | translate }}</span>
                } @else if (contactForm.get('name')?.hasError('pattern')) {
                  <span class="error-message">
                    {{ translate.currentLang === 'ar' ? 'الاسم يجب أن يحتوي على حروف فقط' : 'Name must contain only letters' }}
                  </span>
                }
              }
            </div>
          </div>

          <div class="flex flex-col ">
            <input formControlName="email" type="email" id="email"
            autocomplete="email"
              class="general-input w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="{{ 'pages.contact.EMAIL_ADDRESS_PLACEHOLDER' | translate }}" />
            <div class="error-container">
              @if (contactForm.get('email')?.touched && contactForm.get('email')?.invalid) {
                @if (contactForm.get('email')?.hasError('required')) {
                  <span class="error-message">{{ 'pages.contact.EMAIL_REQUIRED_ERROR' | translate }}</span>
                } @else if (contactForm.get('email')?.hasError('email')) {
                  <span class="error-message">{{ 'pages.contact.EMAIL_VALID_ERROR' | translate }}</span>
                }
              }
            </div>
          </div>

          <div class="flex flex-col ">
            <input formControlName="phone" autocomplete="tel" type="tel" id="phone" [dir]="getDirection()  "  (input)="RestirctToNumbers($event)"
              class="general-input w-full   border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="{{ 'pages.contact.PHONE_NUMBER_PLACEHOLDER' | translate }}" />
            <div class="error-container">
              @if (contactForm.get('phone')?.touched && contactForm.get('phone')?.invalid) {
                @if (contactForm.get('phone')?.hasError('required')) {
                  <span class="error-message">{{ 'pages.contact.PHONE_REQUIRED_ERROR' | translate }}</span>
                } @else if (contactForm.get('phone')?.hasError('pattern')) {
                  <span class="error-message">{{ 'pages.contact.PHONE_VALID_ERROR' | translate }}</span>
                }
              }
            </div>
          </div>

          <div class="flex flex-col ">
            <textarea formControlName="message" id="message"
              class="text-area  resize-none mt-2 w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[120px]"
              placeholder="{{ 'pages.contact.YOUR_MESSAGE_PLACEHOLDER' | translate }}"></textarea>
            <div class="error-container">
              @if (contactForm.get('message')?.touched && contactForm.get('message')?.invalid) {
                @if (contactForm.get('message')?.hasError('required')) {
                  <span class="error-message">{{ 'pages.contact.MESSAGE_REQUIRED_ERROR' | translate }}</span>
                } @else if (contactForm.get('message')?.hasError('minlength')) {
                  <span class="error-message">{{ 'pages.contact.MESSAGE_MINLENGTH_ERROR' | translate }}</span>
                }
              }
            </div>
          </div>

          <button type="submit" class="submit-form-long mt-2 h-[60px] md:h-[80px]">{{ 'pages.contact.SUBMIT_MESSAGE' | translate }}</button>
        </form>
      </div>
    }
  </div>
</div>