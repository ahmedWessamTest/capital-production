

<section class="overflow-x-hidden carousel-container" role="region" aria-label="Featured content carousel">
  <!-- Skeleton Loading State -->
  <div *ngIf="isLoading" class="skeleton-container">
    <div class="hero-gradient h-[100vh] relative overflow-hidden flex items-center">
      <div class="container mx-auto px-4 md:px-8 z-10">
        <div class="max-w-[1200px] px-18">
          <div class="skeleton-title mb-4">
            <div class="h-12 md:h-16 bg-white/20 rounded-lg animate-pulse mb-2"></div>
            <div class="h-12 md:h-16 bg-white/15 rounded-lg animate-pulse w-3/4"></div>
          </div>
          <div class="skeleton-description mb-8">
            <div class="h-6 bg-white/20 rounded-lg animate-pulse mb-2"></div>
            <div class="h-6 bg-white/15 rounded-lg animate-pulse w-4/5 mb-2"></div>
            <div class="h-6 bg-white/10 rounded-lg animate-pulse w-2/3"></div>
          </div>
          <div class="h-16 w-56 bg-white/20 rounded-full animate-pulse"></div>
        </div>
      </div>
      <div class="absolute -z-10 right-0 bottom-0 left-0 w-full h-full bg-gradient-to-r from-gray-300 to-gray-400 animate-pulse"></div>
    </div>
    <nav class="carousel-navigation absolute bottom-8 left-0 right-0 z-30 flex justify-center space-x-3">
      <div class="w-12 h-4 rounded-[10px] bg-white/30 animate-pulse"></div>
      <div class="w-12 h-4 rounded-[10px] bg-white/20 animate-pulse"></div>
      <div class="w-12 h-4 rounded-[10px] bg-white/20 animate-pulse"></div>
    </nav>
  </div>

  <!-- Actual Carousel -->
  <div *ngIf="!isLoading" class="carousel-wrapper">
    <owl-carousel-o
      [options]="customOptions"
      (translated)="getData($event)"
      (initialized)="getData($event)"
      #owlCar
      role="region"
      aria-label="Carousel slides"
    >
      <ng-container *ngFor="let slide of slides; let i = index; trackBy: trackBySlideId">
        <ng-template
          carouselSlide
          [id]="slide.id"
          [dataHash]="slide.id"
          let-owlItem
        >
          <figure
            [style.height]="sliderHeight"
            class="hero-gradient min-h-[500px] relative overflow-hidden flex items-center"
            aria-label="Slide"
          >
            <div class="absolute -z-10 right-0 bottom-0 left-0 w-full h-full pointer-events-none block">
              <img
              [src]="slide.image"
              [alt]="slide.alt || 'Image for ' + slide.en_title"
              class="h-full w-full object-cover"
              [attr.loading]="i === 0 ? 'eager' : 'lazy'"
              [attr.fetchpriority]="i === 0 ? 'high' : 'low'"
              sizes="(max-width: 768px) 100vw, 100vw"
              [attr.decoding]="i === 0 ? 'sync' : 'async'"
              [attr.importance]="i === 0 ? 'high' : 'low'"
              [attr.srcset]="slide.image + ' 1x'"
            /> 
            </div>
            <div class="container mx-auto px-4 md:px-22 z-10">
              <section
                class="max-w-[1200px] text-white"
                [attr.key]="currentSlideKey + '-' + i"
                *ngIf="activeSlideIndex === i"
                role="region"
                aria-label="Slide content"
              >
                <h1
                  class="text-4xl md:text-5xl font-bold mb-4"
                  [id]="'slide-title-' + slide.id"
                >
                  {{ getTitle(slide) }}
                </h1>
                <p
                  class="text-lg md:text-xl mb-8 word-spacing-ar"
                  [id]="'slide-description-' + slide.id"
                >
                  {{ getDescription(slide) }}
                </p>
                <a [href]="aboutDownload" target="_blank" rel="noopener noreferrer">
                  <button
                    class="h-16 w-56 bg-[#174a77] rounded-full text-[#79c7ee] cursor-pointer hover:text-white transition-all duration-300"
                    [attr.aria-label]="getButtonText(slide) + ' for ' + getTitle(slide)"
                  >
                    {{ getButtonText(slide) }}
                  </button>
                </a>
              </section>
            </div>
          </figure>
        </ng-template>
      </ng-container>
    </owl-carousel-o>
  </div>

  <!-- Navigation -->
  <nav *ngIf="!isLoading" class="carousel-navigation absolute bottom-8 left-0 right-0 z-30 flex justify-center space-x-3"
       aria-label="Carousel navigation controls">
    <ng-container *ngFor="let slide of slides; let i = index; trackBy: trackBySlideId">
      <button
        class="w-12 h-4 rounded-[10px] cursor-pointer !border-white transition-all duration-150 hover:scale-110"
        [ngClass]="{
          'bg-sky-400 shadow-lg border-2 border-white': activeSlideIndex === i,
          'bg-white/30 border-[1.5px] border-white hover:bg-white/50': activeSlideIndex !== i
        }"
        (click)="moveToSlide(owlCar, slide.id)"
        [attr.aria-label]="slide.en_title + ' - Go to slide ' + (i + 1)"
      ></button>
    </ng-container>
  </nav>
  
  <div id="carousel-live-region" aria-live="polite" aria-atomic="true" class="sr-only"></div>
</section>