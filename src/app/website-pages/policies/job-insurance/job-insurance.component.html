<div
  class="bg-white my-5  relative"
  [dir]="translate.currentLang === 'ar' ? 'rtl' : 'ltr'"
>
  <div
    class="mx-5 md:mx-10 lg:mx-20 overflow-hidden pt-8 pb-0 relative flex flex-col md:flex-row gap-4 mb-12 bg-gradient-to-br from-[#F2F2F2] from-[15.48%] via-[#DBEFFD] via-[63.88%] to-[#DBEFFD] rounded-lg shadow-lg justify-evenly"
  >
    <img
      *ngIf="showForm"
      (click)="showForm = !showForm"
      class="absolute z-10 w-[40px] h-[40px] top-[10px] start-[10px] cursor-pointer hover:scale-120 transition-all duration-300"
      src="assets/common/back.svg"
      alt=""
      [class.rotate-180]="currentLanguage === 'ar'"
    />
    <!-- Text content with separate loading state -->
    <div
      class="z-10 policy-top-card px-6 md:px-8 lg:px-12 flex flex-col gap-4 justify-center w-full md:w-3/4 transition-all duration-300"
      [ngClass]="{ 'mt-4': showForm }"
    >
      <!-- Text content skeleton loader -->
      <div
        *ngIf="isTextContentLoading"
        class="animate-pulse flex flex-col gap-4"
      >
        <div class="h-8 md:h-10 lg:h-12 bg-gray-200 rounded w-3/4"></div>
        <div class="space-y-2">
          <div class="h-4 bg-gray-200 rounded w-full"></div>
          <div class="h-4 bg-gray-200 rounded w-5/6"></div>
        </div>
        <div
          class="flex flex-col items-start md:flex-row md:items-center gap-4 !mb-8 mt-4"
        >
          <div class="h-10 bg-gray-200 rounded-lg w-32"></div>
        </div>
      </div>
      <!-- Actual text content -->
      <div *ngIf="!isTextContentLoading">
        <div
          class="text-xl md:text-2xl lg:text-3xl font-semibold text-gray-800"
        >
          {{
            currentLanguage === "ar" ? category?.ar_title : category?.en_title
          }}
        </div>
        <p class="text-sm md:text-base text-gray-600">
          {{
            currentLanguage === "ar"
              ? category?.ar_small_description
              : category?.en_small_description
          }}
        </p>
        <div
          class="flex flex-col items-start md:flex-row md:items-center gap-4 !mb-8 mt-4"
        >
          <button
            *ngIf="!showForm"
            class="main-btn  bg-[#00AEEF] text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm md:text-base"
            (click)=" scrollToForm(); showForm = true;showSelectLead = true"
          >
            {{ "pages.building_policy.claim_data_button" | translate }}
          </button>
        </div>
      </div>
    </div>
    <!-- Image section with separate loading state -->
    <div class="h-auto w-full md:w-[580px] flex items-end justify-center">
      <!-- Image skeleton loader -->
      <div
        *ngIf="isImageLoading"
        class="w-full h-full animate-pulse bg-gray-200 rounded-b-lg md:rounded-none flex items-center justify-center"
      >
        <div
          class="w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center"
        >
          <svg
            class="w-8 h-8 text-gray-400"
            fill="currentColor"
            viewBox="0 0 20 20"
          >
            <path
              fill-rule="evenodd"
              d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"
              clip-rule="evenodd"
            />
          </svg>
        </div>
      </div>
      <!-- Actual image -->
      <img
        *ngIf="!isImageLoading"
        class=" md:w-[400px] md:h-[400px]  rounded-b-lg md:rounded-none transition-opacity duration-300"
        src="assets/policies/job.webp"
        alt="{{
          'pages.professional_indemnity.professional_indemnity_image_alt'
            | translate
        }}"
        (load)="onImageLoad()"
        (error)="onImageError()"
        [style.opacity]="imageLoaded ? 1 : 0"
      />
    </div>
    <!-- Gradient background image -->
    <img
      [ngStyle]="{ opacity: showForm ? 1 : 0 }"
      src="assets/common/gradient.png"
      class="absolute bottom-0 z-0 transition-opacity duration-300"
      [ngClass]="{
        '-left-10': translate.currentLang === 'en',
        '-right-10': translate.currentLang === 'ar'
      }"
      alt="{{ 'pages.building_policy.gradient_image_alt' | translate }}"
    />
  </div>
  <div [class.hidden]="!showForm">
    <app-job-individual-form
      *ngIf="leadType === 'individual'" 
    />
    <app-job-corporate-form
      *ngIf="leadType === 'corporate'"
    />
    <app-lead-type-selector [config]="leadTypeConfig"
    [selectedValue]="userSelectedLead"
    componentId="lead-type-choice"
    radioGroupName="jobType"
    (selectionChange)="onLeadTypeSelected($event)"
    (nextClick)="selectFrom()" id="lead-type-choice" *ngIf="showSelectLead && !leadType"/>
  </div>
  </div>

<div
  *ngIf="!showForm"
  class="mx-5 max-h-[933px] overflow-y-auto md:mx-10 lg:mx-20 py-2 px-4 md:px-12 rounded-[40px] bg-[url('assets/policies/big-cover.png')] bg-no-repeat bg-center bg-cover"
>
  <div
    class="flex flex-col gap-4 md:gap-12 p-4 capitalize prose"
    [innerHTML]="
      (currentLanguage
        ? currentLanguage === 'ar'
          ? category?.ar_main_description
          : category?.en_main_description
        : ''
      ) | safeHtml
    "
  ></div>
</div>

<div
  *ngIf="!showForm"
  class="mx-5 mt-12 md:mx-10 lg:mx-20 p-4 md:p-8 rounded-[20px] bg-[url('assets/policies/small-cover.png')] bg-no-repeat bg-center bg-cover"
>
  <div
    class="w-full flex flex-col lg:flex-row gap-8 lg:gap-16 capitalize justify-center items-center"
  >
    <!-- Arc/Circle Section -->
    <div
      class="relative w-64 h-64 sm:w-72 sm:h-72 md:w-86 md:h-86 flex items-center justify-center mx-auto lg:mx-0"
    >
      <!-- Half-white border copy under the main arc -->
      <div
        class="absolute w-64 h-64 sm:w-72 sm:h-72 md:w-86 md:h-86 rounded-full border-[18px] sm:border-[20px] md:border-[24px] border-transparent border-t-white rotate-[246deg]"
      ></div>

      <!-- Main blue arc -->
      <div
        class="absolute w-64 h-64 sm:w-72 sm:h-72 md:w-86 md:h-86 rounded-full border-[18px] sm:border-[20px] md:border-[24px] border-transparent border-t-[#37A6DE] border-l-[#37A6DE] border-r-[#37A6DE] rotate-[16deg]"
      ></div>

      <!-- Middle light blue ring -->
      <div
        class="absolute w-40 h-40 sm:w-48 sm:h-48 md:w-58 md:h-58 rounded-full border-[30px] sm:border-[36px] md:border-[40px] border-[#A9D5EB] bg-transparent"
      ></div>

      <!-- Inner content circle -->
      <div
        *ngIf="counters && counters.length > 0"
        class="z-10 flex flex-col items-center justify-center text-center bg-[#37A6DE] rounded-full w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 shadow-md"
      >
        <div class="text-lg sm:text-xl md:text-[30px] font-bold text-white">
          {{ counters[0].counter_value || 0 }}
        </div>
        <div class="text-sm sm:text-base md:text-[20px] text-white">
          {{
            currentLanguage === "ar" ? counters[0].ar_name : counters[0].en_name
          }}
        </div>
        <div class="text-white mt-2 text-xs sm:text-sm md:text-base">
          <img
            src="assets/policies/job-icon.png"
            alt=""
            class="w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10"
          />
        </div>
      </div>
      <div *ngIf="!counters || counters.length === 0">
        Loading or no data available...
      </div>
    </div>

    <div class="flex flex-col gap-6 items-start justify-center lg:w-[60%]">
      <div class="policy-title2 text-[20px] md:text-[35px]">
        {{ currentLanguage === "ar" ? "نقدم لك" : "Our Progress" }}
      </div>
      <div class="policy-big-title text-[20px] md:text-[35px]">
        {{
          currentLanguage === "ar"
            ? "راحة بالك تبدأ من هنا"
            : "Your peace of mind starts here"
        }}
      </div>
      <ul class="flex flex-col gap-2">
        <li class="leading-[35px] text-justify">
          {{
            currentLanguage === "ar"
              ? "96 وثيقة تأمين على العقارات تغطي احتياجاتك الصحية في كل مرحلة، من الاستشارات إلى العمليات الجراحية الكبرى"
              : "over 96 property insurance policies covering your healthcare needs at every stage, from consultation to major surgeries"
          }}
        </li>
      </ul>
    </div>
  </div>
</div>

<app-partners-logos [policyType]="'job'"></app-partners-logos>
