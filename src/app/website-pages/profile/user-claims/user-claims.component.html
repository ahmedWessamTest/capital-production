<div
  class="min-h-screen my-2 bg-white p-4 sm:p-6"
  [@fadeInOut]="isLoading ? 'loading' : 'loaded'"
>
  <div class="max-w-7xl mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8">
      <div class="space-y-4 sm:space-y-6">
        <div class="space-y-3 sm:space-y-4">
          <!-- Skeleton Loader -->
          <div *ngIf="isLoading" class="space-y-3">
            <div
              *ngFor="let _ of [1, 2, 3]"
              class="card relative animate-pulse"
            >
              <div class="status flex justify-between items-center flex-wrap">
                <div class="flex gap-2 items-center">
                  <div
                    class="status-dot bg-gray-300 w-4 h-4 rounded-full"
                  ></div>
                  <div class="h-6 w-32 bg-gray-200 rounded"></div>
                </div>
                <div class="w-[170px] h-[70px] bg-gray-200 rounded"></div>
              </div>
              <div class="info-grid">
                <div>
                  <div class="label h-4 w-20 bg-gray-200 rounded"></div>
                  <div class="value h-5 w-40 bg-gray-200 rounded"></div>
                </div>
                <div>
                  <div class="label h-4 w-20 bg-gray-200 rounded"></div>
                  <div class="value h-5 w-40 bg-gray-200 rounded"></div>
                </div>
                <div class="expiry">
                  <div class="label h-4 w-20 bg-gray-200 rounded"></div>
                  <div class="value h-5 w-40 bg-gray-200 rounded"></div>
                </div>
              </div>
              <div class="flex items-center gap-2 justify-between">
                <div class="h-8 w-32 bg-gray-200 rounded"></div>
              </div>
            </div>
          </div>

          <!-- Claim Cards -->
          <ng-container *ngIf="!isLoading">
            <div class="flex gap-2 w-full">
              <button
                (click)="switchTab('open')"
                [class]="
                  activeTab === 'open'
                    ? 'select-btn active w-1/2 relative'
                    : 'select-btn w-1/2 relative'
                "
              >
                {{ lang == "ar" ? "الحالي" : "Current" }}
              </button>
              <button
                (click)="switchTab('closed')"
                [class]="
                  activeTab === 'closed'
                    ? 'select-btn active w-1/2 relative'
                    : 'select-btn w-1/2 relative'
                "
              >
                {{ lang == "ar" ? "السابق" : "Previous" }}
              </button>
            </div>

            <ng-container *ngIf="getAllClaimsSorted().length === 0">
              <div class="text-center text-gray-500 text-lg py-8">
                {{ "pages.user_policies.no_data" | translate }}
              </div>
            </ng-container>

            <ng-container *ngFor="let claim of getAllClaimsSorted()">
              <div class="card relative">
                <!-- Pending Banner -->
                <div
                  *ngIf="claim.status === 'pending'"
                  class="absolute top-0 right-0 bg-yellow-400 text-black text-sm font-semibold px-3 py-1 rounded-bl-lg z-30 transform -rotate-2 shadow-md"
                >
                  {{ "pages.claims.status.pending" | translate }}
                </div>
                <div class="status flex justify-between items-center flex-wrap">
                  <div>
                    <div class="flex gap-2 items-center">
                      <div
                        class="status-dot"
                        [ngClass]="{
                          'bg-[#30B479]':
                            claim.status === 'pending' ||
                            claim.status === 'requested' ||
                            claim.status === 'confirmed',
                          'bg-red-600': claim.status === 'canceled'
                        }"
                      ></div>
                      {{ getClaimTypeName(claim.type) }}
                    </div>
                    <div class="subtext">
                      {{ getClaimStatus(claim) }}
                    </div>
                  </div>
                  <div
                    class="w-[170px] h-[85px] z-20 text-center flex justify-center"
                  >
                    <img
                      class="w-full h-full object-cover"
                      [ngClass]="
                        claim.type === 'motor'
                          ? 'object-contain'
                          : 'object-cover'
                      "
                      [src]="
                        claim.type === 'medical'
                          ? '/assets/policies/medical.png'
                          : claim.type === 'motor'
                          ? '/assets/policies/car.png'
                          : claim.type === 'jop'
                          ? '/assets/policies/job.webp'
                          : '/assets/policies/building.png'
                      "
                      alt=""
                      [ngClass]="{
                        'max-w-[125px]': claim.type == 'jop'
                      }"
                    />
                  </div>
                </div>
                <div class="info-grid">
                  <div>
                    <div class="label">
                      {{ "pages.claims.labels.claimant" | translate }}
                    </div>
                    <div class="value">{{ claim.name }}</div>
                  </div>
                  <div>
                    <div class="label">
                      {{ "pages.claims.labels.claim_number" | translate }}
                    </div>
                    <div class="value">{{ claim.claim_number }}</div>
                  </div>
                  <div class="expiry">
                    <div class="label">
                      {{ "pages.claims.labels.claim_date" | translate }}
                    </div>
                    <div
                      class="value"
                      [ngClass]="{
                        '!text-red-600':
                          claim.status !== 'pending' &&
                          claim.status !== 'requested'
                      }"
                    >
                      {{ formatDisplayDate(claim.created_at) }}
                    </div>
                  </div>
                </div>
                <div class="flex items-center gap-2 justify-between">
                  <button
                    [routerLink]="[
                      '/',
                      currentLang$ | async,
                      'claims',
                      claim.id,
                      claim.type === 'jop'?'job':claim.type,
                      'comments'
                    ]"
                    class="show-all-details w-full md:w-1/2"
                  >
                    {{ lang == "ar" ? "اذهب الي التعليقات" : "Go to comments" }}
                  </button>
                </div>
                <img
                  src="/assets/policies/card-policy-bg.svg"
                  alt="Background"
                  class="car-img absolute -top-5 -end-5 w-[180px] z-10 h-[180px]"
                />
              </div>
            </ng-container>
          </ng-container>
        </div>
      </div>
      <div class="hidden lg:block sticky top-6 self-start">
        <div class="w-full max-h-[600px] rounded-4xl overflow-hidden">
          <img
            class="w-full h-full object-cover"
            src="assets/claims/claims-img.jpg"
            alt=""
          />
        </div>
      </div>
    </div>
  </div>
</div>
